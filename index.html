<!DOCTYPE html><html lang="zh-CN" class="bg-[var(--page-bg)] transition text-[14px] md:text-[16px]" data-overlayscrollbars-initialize data-astro-cid-sckkx6r4 style="--bannerOffset: 15vh;--banner-height-home: 65vh;--banner-height: 35vh;--configHue: 215;--page-width: 75rem;--bg-url: url(https://api3-erciyuan-image.xcqcoo.top);--bg-enable: 1;--bg-position: center;--bg-size: cover;--bg-repeat: no-repeat;--bg-attachment: fixed;--bg-opacity: 0.5;"> <head><title>QC3284&#39;s Blog - 乐于分享</title><meta charset="UTF-8"><meta name="description" content="分享一些个人经历即文章和教程的个人技术博客，作者为QC3284"><meta name="author" content="QC3284"><meta name="keywords" content><meta property="og:site_name" content="QC3284's Blog"><meta property="og:url" content="https://blog.xcqcoo.top/"><meta property="og:title" content="QC3284's Blog - 乐于分享"><meta property="og:description" content="分享一些个人经历即文章和教程的个人技术博客，作者为QC3284"><meta property="og:type" content="website"><meta name="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog.xcqcoo.top/"><meta name="twitter:title" content="QC3284's Blog - 乐于分享"><meta name="twitter:description" content="分享一些个人经历即文章和教程的个人技术博客，作者为QC3284"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.7.9"><script src="/js/umami-share.js" defer></script><link rel="icon" href="https://cdn2.xcqcoo.top/gh/QC3284/233@main/yinlang.jpg"><!-- Set the theme before the page is rendered to avoid a flash --><script>(function(){const DEFAULT_THEME = "auto";
const LIGHT_MODE = "light";
const DARK_MODE = "dark";
const AUTO_MODE = "auto";
const BANNER_HEIGHT_EXTEND = 30;
const PAGE_WIDTH = 75;
const configHue = 215;
const forceDarkMode = true;

			// Force dark mode if configured
			if (forceDarkMode) {
				document.documentElement.classList.add('dark');
				localStorage.setItem('theme', DARK_MODE);
			} else {
				// Load the theme from local storage
				const theme = localStorage.getItem('theme') || DEFAULT_THEME;
				switch (theme) {
					case LIGHT_MODE:
						document.documentElement.classList.remove('dark');
						break
					case DARK_MODE:
						document.documentElement.classList.add('dark');
						break
					case AUTO_MODE:
						if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
							document.documentElement.classList.add('dark');
						} else {
							document.documentElement.classList.remove('dark');
						}
				}
			}

			// Load the hue from local storage
			const hue = localStorage.getItem('hue') || configHue;
			document.documentElement.style.setProperty('--hue', hue);

			// calculate the --banner-height-extend, which needs to be a multiple of 4 to avoid blurry text
			let offset = Math.floor(window.innerHeight * (BANNER_HEIGHT_EXTEND / 100));
			offset = offset - offset % 4;
			document.documentElement.style.setProperty('--banner-height-extend', `${offset}px`);

			// Background image loading detection
			const bgUrl = getComputedStyle(document.documentElement).getPropertyValue('--bg-url').trim();
			const bgEnable = getComputedStyle(document.documentElement).getPropertyValue('--bg-enable').trim();
			
			if (bgUrl && bgUrl !== 'none' && bgEnable === '1') {
				const img = new Image();
				const urlMatch = bgUrl.match(/url\(["']?([^"')]+)["']?\)/);
				if (urlMatch) {
					img.onload = function() {
						// 背景图片完全加载后，显示背景并启用卡片透明效果
						document.body.classList.add('bg-loaded');
						document.documentElement.style.setProperty('--card-bg', 'var(--card-bg-transparent)');
						document.documentElement.style.setProperty('--float-panel-bg', 'var(--float-panel-bg-transparent)');
					};
					img.onerror = function() {
						// Keep cards opaque if background image fails to load
						console.warn('Background image failed to load, keeping cards opaque');
					};
					img.src = urlMatch[1];
				}
			}
		})();</script><!-- defines global css variables. This will be applied to <html> <body> and some other elements idk why --><link rel="stylesheet" href="/_astro/Layout.omPQcCVA.css">
<link rel="stylesheet" href="/_astro/Layout.DRe9SoLl.css">
<link rel="stylesheet" href="/_astro/_page_.C6NT1Zvp.css">
<link rel="stylesheet" href="/_astro/_page_.gzYuun_h.css">
<link rel="stylesheet" href="/_astro/about.BtniRLn_.css">
<link rel="stylesheet" href="/_astro/_page_.C3bd0h5r.css">
<style>.friend-card[data-astro-cid-spp2p3no]{display:flex;flex-direction:column;gap:.25rem;border-radius:.5rem;background-color:var(--card-bg);padding:1rem}.friend-card[data-astro-cid-spp2p3no]:hover{background-color:#0000000d}.friend-card[data-astro-cid-spp2p3no]:hover:is(.dark *){background-color:#ffffff0d}.friend-card[data-astro-cid-spp2p3no]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.friend-card[data-astro-cid-spp2p3no]:active{scale:.98;background-color:var(--btn-regular-bg-active)}.friend-card[data-astro-cid-spp2p3no]:hover{background-color:var(--btn-regular-bg-hover)}.friend-card[data-astro-cid-spp2p3no]:hover .font-bold[data-astro-cid-spp2p3no]{color:var(--btn-content)}.friend-card[data-astro-cid-spp2p3no]:hover .text-sm[data-astro-cid-spp2p3no]{--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.friend-card[data-astro-cid-spp2p3no]:hover .text-sm[data-astro-cid-spp2p3no]:is(.dark *){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.friend-card[data-astro-cid-spp2p3no] .font-bold[data-astro-cid-spp2p3no],.friend-card[data-astro-cid-spp2p3no] .text-sm[data-astro-cid-spp2p3no]{transition-property:color;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}
.donate-card[data-astro-cid-3z6uernf]{display:flex;flex-direction:column;border-radius:.5rem;border-width:1px;border-color:#0000001a;background-color:var(--card-bg);padding:1rem;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.donate-card[data-astro-cid-3z6uernf]:hover{border-color:#0003}.donate-card[data-astro-cid-3z6uernf]:is(.dark *){border-color:#ffffff1a}.donate-card[data-astro-cid-3z6uernf]:hover:is(.dark *){border-color:#fff3}.support-card[data-astro-cid-3z6uernf]{border-radius:.5rem;background-color:var(--card-bg);padding:1rem;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.support-card[data-astro-cid-3z6uernf]:hover{background-color:#0000000d}.support-card[data-astro-cid-3z6uernf]:hover:is(.dark *){background-color:#ffffff0d}.qr-code-placeholder[data-astro-cid-3z6uernf]{text-align:center}.sponsors-section[data-astro-cid-3z6uernf]{margin-top:1.5rem}.sponsors-grid[data-astro-cid-3z6uernf]{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:1rem}@media(min-width:768px){.sponsors-grid[data-astro-cid-3z6uernf]{grid-template-columns:repeat(2,minmax(0,1fr))}}@media(min-width:1024px){.sponsors-grid[data-astro-cid-3z6uernf]{grid-template-columns:repeat(3,minmax(0,1fr))}}.sponsor-placeholder[data-astro-cid-3z6uernf]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s}.sponsor-placeholder[data-astro-cid-3z6uernf]:hover{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.sponsor-card[data-astro-cid-3z6uernf]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s}.sponsor-card[data-astro-cid-3z6uernf]:hover{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.crypto-info[data-astro-cid-3z6uernf]>[data-astro-cid-3z6uernf]:not([hidden])~[data-astro-cid-3z6uernf]:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.wallet-address[data-astro-cid-3z6uernf],.bybit-uid[data-astro-cid-3z6uernf]{text-align:center}.copy-btn[data-astro-cid-3z6uernf]{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s}.copy-btn[data-astro-cid-3z6uernf]:hover{color:var(--primary);opacity:.8}
input.svelte-1wah7ro:focus{outline:0}.search-panel.svelte-1wah7ro{max-height:calc(100vh - 100px);overflow-y:auto}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k){-webkit-appearance:none;height:1.5rem;background-image:var(--color-selection-bar);transition:background-image .15s ease-in-out}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-webkit-slider-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-webkit-slider-thumb:hover{background:#fffc}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-webkit-slider-thumb:active{background:#fff9}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-moz-range-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;border-width:0;background:#ffffffb3;box-shadow:none}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-moz-range-thumb:hover{background:#fffc}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-moz-range-thumb:active{background:#fff9}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-ms-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-ms-thumb:hover{background:#fffc}#display-setting.svelte-d7tq3k input[type=range]:where(.svelte-d7tq3k)::-ms-thumb:active{background:#fff9}
</style><script type="module" src="/_astro/page.B-gX5Lgq.js"></script></head> <body class=" min-h-screen transition  lg:is-home" data-overlayscrollbars-initialize data-astro-cid-sckkx6r4 style="--bannerOffset: 15vh;--banner-height-home: 65vh;--banner-height: 35vh;--configHue: 215;--page-width: 75rem;--bg-url: url(https://api3-erciyuan-image.xcqcoo.top);--bg-enable: 1;--bg-position: center;--bg-size: cover;--bg-repeat: no-repeat;--bg-attachment: fixed;--bg-opacity: 0.5;"> <div id="config-carrier" data-hue="215"></div>    <div id="top-row" class="z-50 pointer-events-none relative transition-all duration-700 max-w-[var(--page-width)] px-0 md:px-4 mx-auto"> <div id="navbar-wrapper" class="pointer-events-auto sticky top-0 transition-all"> <div id="navbar" class="z-50 onload-animation"> <div class="absolute h-8 left-0 right-0 -top-8 bg-[var(--card-bg)] transition"></div> <!-- used for onload animation --> <div class="card-base !overflow-visible max-w-[var(--page-width)] h-[4.5rem] !rounded-t-none mx-auto flex items-center justify-between px-4"> <a href="/" class="btn-plain scale-animation rounded-lg h-[3.25rem] px-5 font-bold active:scale-95"> <div class="flex flex-row text-[var(--primary)] items-center text-md"> <svg width="1em" height="1em" class="text-[1.75rem] mb-1 mr-2" data-icon="material-symbols:home-outline-rounded">   <symbol id="ai:material-symbols:home-outline-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M6 19h3v-5q0-.425.288-.712T10 13h4q.425 0 .713.288T15 14v5h3v-9l-6-4.5L6 10zm-2 0v-9q0-.475.213-.9t.587-.7l6-4.5q.525-.4 1.2-.4t1.2.4l6 4.5q.375.275.588.7T20 10v9q0 .825-.588 1.413T18 21h-4q-.425 0-.712-.288T13 20v-5h-2v5q0 .425-.288.713T10 21H6q-.825 0-1.412-.587T4 19m8-6.75"/></symbol><use href="#ai:material-symbols:home-outline-rounded"></use>  </svg> QC3284&#39;s Blog </div> </a> <div class="hidden md:flex"> <a aria-label="首页" href="/" class="btn-plain scale-animation rounded-lg h-11 font-bold px-5 active:scale-95"> <div class="flex items-center"> 首页  </div> </a><a aria-label="归档" href="/archive/" class="btn-plain scale-animation rounded-lg h-11 font-bold px-5 active:scale-95"> <div class="flex items-center"> 归档  </div> </a><a aria-label="关于" href="/about/" class="btn-plain scale-animation rounded-lg h-11 font-bold px-5 active:scale-95"> <div class="flex items-center"> 关于  </div> </a><a aria-label="友链" href="/friends/" class="btn-plain scale-animation rounded-lg h-11 font-bold px-5 active:scale-95"> <div class="flex items-center"> 友链  </div> </a> </div> <div class="flex"> <!--<SearchPanel client:load>--> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="1OjqH8" component-url="/_astro/Search.QVE2EyC-.js" component-export="default" renderer-url="/_astro/client.svelte.Bcdz7Meu.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;Search&quot;,&quot;value&quot;:&quot;svelte&quot;}"></astro-island> <button aria-label="Display Settings" class="btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90" id="display-settings-switch"> <svg width="1em" height="1em" class="text-[1.25rem]" data-icon="material-symbols:palette-outline">   <symbol id="ai:material-symbols:palette-outline" viewBox="0 0 24 24"><path fill="currentColor" d="M12 22q-2.05 0-3.875-.788t-3.187-2.15t-2.15-3.187T2 12q0-2.075.813-3.9t2.2-3.175T8.25 2.788T12.2 2q2 0 3.775.688t3.113 1.9t2.125 2.875T22 11.05q0 2.875-1.75 4.413T16 17h-1.85q-.225 0-.312.125t-.088.275q0 .3.375.863t.375 1.287q0 1.25-.687 1.85T12 22m-5.5-9q.65 0 1.075-.425T8 11.5t-.425-1.075T6.5 10t-1.075.425T5 11.5t.425 1.075T6.5 13m3-4q.65 0 1.075-.425T11 7.5t-.425-1.075T9.5 6t-1.075.425T8 7.5t.425 1.075T9.5 9m5 0q.65 0 1.075-.425T16 7.5t-.425-1.075T14.5 6t-1.075.425T13 7.5t.425 1.075T14.5 9m3 4q.65 0 1.075-.425T19 11.5t-.425-1.075T17.5 10t-1.075.425T16 11.5t.425 1.075T17.5 13M12 20q.225 0 .363-.125t.137-.325q0-.35-.375-.825T11.75 17.3q0-1.05.725-1.675T14.25 15H16q1.65 0 2.825-.962T20 11.05q0-3.025-2.312-5.038T12.2 4Q8.8 4 6.4 6.325T4 12q0 3.325 2.338 5.663T12 20"/></symbol><use href="#ai:material-symbols:palette-outline"></use>  </svg> </button> <button aria-label="Menu" name="Nav Menu" class="btn-plain scale-animation rounded-lg w-11 h-11 active:scale-90 md:!hidden" id="nav-menu-switch"> <svg width="1em" height="1em" class="text-[1.25rem]" data-icon="material-symbols:menu-rounded">   <symbol id="ai:material-symbols:menu-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h16q.425 0 .713.288T21 17t-.288.713T20 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z"/></symbol><use href="#ai:material-symbols:menu-rounded"></use>  </svg> </button> </div> <div id="nav-menu-panel" class="float-panel float-panel-closed absolute transition-all fixed right-4 px-2 py-2"> <a href="/" class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
            hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)] transition
        "> <div class="transition text-black/75 dark:text-white/75 font-bold group-hover:text-[var(--primary)] group-active:text-[var(--primary)]"> 首页 </div> <svg width="1em" height="1em" class="transition text-[1.25rem] text-[var(--primary)]" data-icon="material-symbols:chevron-right-rounded">   <symbol id="ai:material-symbols:chevron-right-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M12.6 12L8.7 8.1q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.6 4.6q.15.15.213.325t.062.375t-.062.375t-.213.325l-4.6 4.6q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7z"/></symbol><use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg>  </a><a href="/archive/" class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
            hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)] transition
        "> <div class="transition text-black/75 dark:text-white/75 font-bold group-hover:text-[var(--primary)] group-active:text-[var(--primary)]"> 归档 </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition text-[1.25rem] text-[var(--primary)]" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg>  </a><a href="/about/" class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
            hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)] transition
        "> <div class="transition text-black/75 dark:text-white/75 font-bold group-hover:text-[var(--primary)] group-active:text-[var(--primary)]"> 关于 </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition text-[1.25rem] text-[var(--primary)]" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg>  </a><a href="/friends/" class="group flex justify-between items-center py-2 pl-3 pr-1 rounded-lg gap-8
            hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)] transition
        "> <div class="transition text-black/75 dark:text-white/75 font-bold group-hover:text-[var(--primary)] group-active:text-[var(--primary)]"> 友链 </div> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition text-[1.25rem] text-[var(--primary)]" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg>  </a> </div> <astro-island uid="Z1Psfhf" component-url="/_astro/DisplaySettings.Cjw1DMLz.js" component-export="default" renderer-url="/_astro/client.svelte.Bcdz7Meu.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;DisplaySettings&quot;,&quot;value&quot;:&quot;svelte&quot;}"></astro-island> </div> </div> <script type="module">function l(){let e=document.getElementById("display-settings-switch");e&&(e.onclick=function(){let t=document.getElementById("display-setting");t&&t.classList.toggle("float-panel-closed")});let n=document.getElementById("nav-menu-switch");n&&(n.onclick=function(){let t=document.getElementById("nav-menu-panel");t&&t.classList.toggle("float-panel-closed")})}l();</script> </div> </div>   <div class="absolute w-full z-30 pointer-events-none" style="top: 5.5rem"> <!-- The pointer-events-none here prevent blocking the click event of the TOC --> <div class="relative max-w-[var(--page-width)] mx-auto pointer-events-auto"> <div id="main-grid" class="transition duration-700 w-full left-0 right-0 grid grid-cols-[17.5rem_auto] grid-rows-[auto_1fr_auto] lg:grid-rows-[auto]
    mx-auto gap-4 px-0 md:px-4"> <!-- Banner image credit -->  <div id="sidebar" class="mb-4 row-start-2 row-end-3 col-span-2 lg:row-start-1 lg:row-end-2 lg:col-span-1 lg:max-w-[17.5rem] onload-animation w-full"> <div class="flex flex-col w-full gap-4 mb-4"> <div class="card-base p-3"> <a aria-label="Go to About Page" href="/about/" class="group block relative mx-auto mt-1 lg:mx-0 lg:mt-0 mb-3
       max-w-[12rem] lg:max-w-none overflow-hidden rounded-xl active:scale-95"> <div class="absolute transition pointer-events-none group-hover:bg-black/30 group-active:bg-black/50
        w-full h-full z-50 flex items-center justify-center"> <svg width="1.13em" height="1em" class="transition opacity-0 scale-90 group-hover:scale-100 group-hover:opacity-100 text-white text-5xl" data-icon="fa6-regular:address-card">   <symbol id="ai:fa6-regular:address-card" viewBox="0 0 576 512"><path fill="currentColor" d="M512 80c8.8 0 16 7.2 16 16v320c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V96c0-8.8 7.2-16 16-16zM64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64zm144 224a64 64 0 1 0 0-128a64 64 0 1 0 0 128m-32 32c-44.2 0-80 35.8-80 80c0 8.8 7.2 16 16 16h192c8.8 0 16-7.2 16-16c0-44.2-35.8-80-80-80zm200-144c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24z"/></symbol><use href="#ai:fa6-regular:address-card"></use>  </svg> </div> <div class="mx-auto lg:w-full h-full lg:mt-0  overflow-hidden relative image-wrapper" style="--theme-hue: 215" data-astro-cid-i2xmscho> <!-- 加载条 --> <div class="loading-bar absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-1 bg-gray-200 dark:bg-gray-700 z-10 rounded-full overflow-hidden" data-astro-cid-i2xmscho> <div class="loading-progress h-full w-8 bg-[oklch(0.70_0.14_var(--theme-hue))] animate-loading-progress rounded-full" data-astro-cid-i2xmscho></div> </div> <!-- 图片内容 -->  <img src="https://cdn2.xcqcoo.top/gh/QC3284/233@main/yinlang.jpg" alt="Profile Image of the Author" class="w-full h-full object-cover image-content opacity-0 transition-opacity duration-500" style="object-position: center" onload="this.style.opacity='1'; this.parentElement.querySelector('.loading-bar').style.opacity='0';" data-astro-cid-i2xmscho> </div>  </a> <div class="px-2"> <div class="font-bold text-xl text-center mb-1 dark:text-neutral-50 transition">QC3284</div> <div class="h-1 w-5 bg-[var(--primary)] mx-auto rounded-full mb-2 transition"></div> <div class="text-center text-neutral-400 mb-2.5 transition">Dare to explore!</div> <div class="flex flex-wrap gap-2 justify-center mb-1"> <a rel="me" aria-label="Bilibli" href="https://space.bilibili.com/510234024" target="_blank" class="btn-regular rounded-lg h-10 w-10 active:scale-90"> <svg width="1em" height="1em" class="text-[1.5rem]" data-icon="fa6-brands:bilibili">   <symbol id="ai:fa6-brands:bilibili" viewBox="0 0 512 512"><path fill="currentColor" d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1c-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79c0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0q13.2 0 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0q13.2 0 21.9 8.603c5.7 5.737 8.6 12.997 8.6 21.797c0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5c-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8c-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2c-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5s-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5s-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></symbol><use href="#ai:fa6-brands:bilibili"></use>  </svg> </a><a rel="me" aria-label="GitHub" href="https://github.com/QC3284" target="_blank" class="btn-regular rounded-lg h-10 w-10 active:scale-90"> <svg width="0.97em" height="1em" class="text-[1.5rem]" data-icon="fa6-brands:github">   <symbol id="ai:fa6-brands:github" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></symbol><use href="#ai:fa6-brands:github"></use>  </svg> </a>  </div> <!-- 全站访问量统计 --> <div class="grid grid-cols-2 mt-3 pt-3 border-t border-neutral-200 dark:border-neutral-700"> <div class="text-center"> <div class="text-xs text-neutral-500 mb-1 flex items-center justify-center gap-1"> <svg width="1em" height="1em" class="text-base" data-icon="material-symbols:visibility-outline">   <symbol id="ai:material-symbols:visibility-outline" viewBox="0 0 24 24"><path fill="currentColor" d="M12 16q1.875 0 3.188-1.312T16.5 11.5t-1.312-3.187T12 7T8.813 8.313T7.5 11.5t1.313 3.188T12 16m0-1.8q-1.125 0-1.912-.788T9.3 11.5t.788-1.912T12 8.8t1.913.788t.787 1.912t-.787 1.913T12 14.2m0 4.8q-3.65 0-6.65-2.037T1 11.5q1.35-3.425 4.35-5.462T12 4t6.65 2.038T23 11.5q-1.35 3.425-4.35 5.463T12 19m0-2q2.825 0 5.188-1.487T20.8 11.5q-1.25-2.525-3.613-4.012T12 6T6.813 7.488T3.2 11.5q1.25 2.525 3.613 4.013T12 17"/></symbol><use href="#ai:material-symbols:visibility-outline"></use>  </svg> <span class="text-xs">访问量</span> </div> <div id="site-views" class="font-bold text-lg text-neutral-700 dark:text-neutral-300">-</div> </div> <div class="text-center border-l border-neutral-200 dark:border-neutral-700"> <div class="text-xs text-neutral-500 mb-1 flex items-center justify-center gap-1"> <svg width="1em" height="1em" class="text-base" data-icon="material-symbols:person">   <symbol id="ai:material-symbols:person" viewBox="0 0 24 24"><path fill="currentColor" d="M12 12q-1.65 0-2.825-1.175T8 8t1.175-2.825T12 4t2.825 1.175T16 8t-1.175 2.825T12 12m-8 8v-2.8q0-.85.438-1.562T5.6 14.55q1.55-.775 3.15-1.162T12 13t3.25.388t3.15 1.162q.725.375 1.163 1.088T20 17.2V20z"/></symbol><use href="#ai:material-symbols:person"></use>  </svg> <span class="text-xs">访客数</span> </div> <div id="site-visitors" class="font-bold text-lg text-neutral-700 dark:text-neutral-300">-</div> </div> </div> </div> </div> <script>(function(){const umamiConfig = {"enable":false,"baseUrl":"","shareId":"","timezone":"Asia/Shanghai"};

    // 获取全站访问量统计
    async function loadSiteStats() {
        if (!umamiConfig.enable) {
            return;
        }
        
        try {
            // 调用全局工具获取 Umami 分享数据
            const { websiteId, token } = await getUmamiShareData(umamiConfig.baseUrl, umamiConfig.shareId);
            
            // 第二步：获取全站统计数据（不指定url参数获取全站数据）
            const currentTimestamp = Date.now();
            const statsUrl = `${umamiConfig.baseUrl}/api/websites/${websiteId}/stats?startAt=0&endAt=${currentTimestamp}&unit=hour&timezone=${encodeURIComponent(umamiConfig.timezone)}&compare=false`;
            
            const statsResponse = await fetch(statsUrl, {
                 headers: {
                     'x-umami-share-token': token
                 }
             });
            
            if (statsResponse.status === 401) {
                // token 失效，清理缓存后重新获取一次
                clearUmamiShareCache();
                return await loadSiteStats();
            }
            
            if (!statsResponse.ok) {
                throw new Error('获取统计数据失败');
            }
            
            const statsData = await statsResponse.json();
            const pageviews = statsData.pageviews || 0;
            const visitors = statsData.visitors || 0;
            
            const viewsElement = document.getElementById('site-views');
            const visitorsElement = document.getElementById('site-visitors');
            if (viewsElement) {
                viewsElement.textContent = pageviews;
            }
            if (visitorsElement) {
                visitorsElement.textContent = visitors;
            }
        } catch (error) {
            console.error('获取全站统计失败:', error);
        }
    }

    // 页面加载完成后获取统计数据
    document.addEventListener('DOMContentLoaded', loadSiteStats);
})();</script> </div> <div id="sidebar-sticky" class="transition-all duration-700 flex flex-col w-full gap-4 top-4 sticky top-4"> <widget-layout data-id="domain-switcher" data-is-collapsed="undefined" class="pb-4 card-base onload-animation" style="animation-delay: 150ms; " data-astro-cid-ucso7hve="true"> <div class="font-bold transition text-lg text-neutral-900 dark:text-neutral-100 relative ml-8 mt-4 mb-2
        before:w-1 before:h-4 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:left-[-16px] before:top-[5.5px]" data-astro-cid-ucso7hve style="">线路切换</div> <div id="domain-switcher" class="collapse-wrapper px-4 overflow-hidden" data-astro-cid-ucso7hve style="">  <div class="flex flex-col gap-2"> <a href="https://blog.xcqcoo.top" data-url="https://blog.xcqcoo.top" class="domain-link btn-regular !justify-between px-3 py-2 rounded-lg text-sm group" data-domain="blog.xcqcoo.top"> <span class="truncate">Netlify</span> <div class="flex items-center gap-2"> <span class="latency-text text-xs font-bold opacity-0 transition-opacity"></span> <span class="status-indicator w-2 h-2 rounded-full bg-[var(--btn-content)]/30 dark:bg-white/30"></span> </div> </a><a href="https://cf-blog.xcqcoo.top" data-url="https://cf-blog.xcqcoo.top" class="domain-link btn-regular !justify-between px-3 py-2 rounded-lg text-sm group" data-domain="cf-blog.xcqcoo.top"> <span class="truncate">Cloudflare</span> <div class="flex items-center gap-2"> <span class="latency-text text-xs font-bold opacity-0 transition-opacity"></span> <span class="status-indicator w-2 h-2 rounded-full bg-[var(--btn-content)]/30 dark:bg-white/30"></span> </div> </a><a href="https://eo-blog.xcqcoo.top" data-url="https://eo-blog.xcqcoo.top" class="domain-link btn-regular !justify-between px-3 py-2 rounded-lg text-sm group" data-domain="eo-blog.xcqcoo.top"> <span class="truncate">EdgeOne</span> <div class="flex items-center gap-2"> <span class="latency-text text-xs font-bold opacity-0 transition-opacity"></span> <span class="status-indicator w-2 h-2 rounded-full bg-[var(--btn-content)]/30 dark:bg-white/30"></span> </div> </a><a href="http://localhost:4321" data-url="http://localhost:4321" class="domain-link btn-regular !justify-between px-3 py-2 rounded-lg text-sm group" data-domain="localhost"> <span class="truncate">Dev</span> <div class="flex items-center gap-2"> <span class="latency-text text-xs font-bold opacity-0 transition-opacity"></span> <span class="status-indicator w-2 h-2 rounded-full bg-[var(--btn-content)]/30 dark:bg-white/30"></span> </div> </a> </div>  </div>  </widget-layout>   <script type="module">function l(){const r=window.location.hostname;document.querySelectorAll(".domain-link").forEach(a=>{const t=a.getAttribute("data-domain"),e=a.getAttribute("href");a.className="domain-link btn-regular !justify-between px-3 py-2 rounded-lg text-sm group";const o=a.querySelector(".status-indicator");if(o&&(o.className="status-indicator w-2 h-2 rounded-full bg-[var(--btn-content)]/30 dark:bg-white/30"),t===r)a.classList.remove("btn-regular"),a.classList.add("flex","items-center","justify-between","bg-[var(--primary)]","text-white","dark:text-black/70","cursor-default"),o&&(o.classList.remove("bg-[var(--btn-content)]/30","dark:bg-white/30"),o.classList.add("bg-white","dark:bg-black/70")),a.removeAttribute("href");else if(e)try{const s=new URL(e);s.pathname=window.location.pathname,s.search=window.location.search,s.hash=window.location.hash,a.setAttribute("href",s.toString())}catch{console.error("Invalid URL:",e)}})}async function d(){const r=document.querySelectorAll(".domain-link");for(const n of r){const a=n.getAttribute("data-url"),t=n.querySelector(".latency-text"),e=n.querySelector(".status-indicator");if(!a||!t)continue;t.textContent="...",t.classList.remove("opacity-0","text-green-500","text-yellow-500","text-red-500"),t.classList.add("opacity-50");const o=performance.now();let s=-1;try{const c=new AbortController,u=setTimeout(()=>c.abort(),5e3);await fetch(a,{method:"HEAD",mode:"no-cors",cache:"no-store",signal:c.signal}),clearTimeout(u);const b=performance.now();s=Math.round(b-o)}catch{}t.classList.remove("opacity-50");const i=n.classList.contains("bg-[var(--primary)]");s>=0?(t.textContent=`${s}ms`,s<200?i||(t.classList.add("text-green-600","dark:text-green-400"),e&&(e.classList.remove("bg-[var(--btn-content)]/30","dark:bg-white/30"),e.classList.add("bg-green-500"))):s<500?i||(t.classList.add("text-yellow-600","dark:text-yellow-400"),e&&(e.classList.remove("bg-[var(--btn-content)]/30","dark:bg-white/30"),e.classList.add("bg-yellow-500"))):(t.classList.add("text-red-600","dark:text-red-400"),e&&!i&&(e.classList.remove("bg-[var(--btn-content)]/30","dark:bg-white/30"),e.classList.add("bg-red-500")))):(t.textContent="-",t.classList.add("text-red-600","dark:text-red-400"))}}l();d();document.addEventListener("astro:page-load",()=>{l(),d()});</script> <widget-layout data-id="tags" data-is-collapsed="false" class="pb-4 card-base onload-animation" style="animation-delay: 200ms; --collapsedHeight: 7.5rem;" data-astro-cid-ucso7hve="true"> <div class="font-bold transition text-lg text-neutral-900 dark:text-neutral-100 relative ml-8 mt-4 mb-2
        before:w-1 before:h-4 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:left-[-16px] before:top-[5.5px]" data-astro-cid-ucso7hve style="--collapsedHeight: 7.5rem;">标签</div> <div id="tags" class="collapse-wrapper px-4 overflow-hidden" data-astro-cid-ucso7hve style="--collapsedHeight: 7.5rem;">  <div class="flex gap-2 flex-wrap"> <a href="/archive/tag/luci-app-fakemesh/" aria-label="View all posts with the luci-app-fakemesh tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  luci-app-fakemesh </a><a href="/archive/tag/mesh/" aria-label="View all posts with the mesh tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  mesh </a><a href="/archive/tag/openwrt/" aria-label="View all posts with the openwrt tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  openwrt </a><a href="/archive/tag/OpenWrt/" aria-label="View all posts with the OpenWrt tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  OpenWrt </a><a href="/archive/tag/SSH/" aria-label="View all posts with the SSH tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  SSH </a><a href="/archive/tag/ssh/" aria-label="View all posts with the ssh tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  ssh </a><a href="/archive/tag/VPS/" aria-label="View all posts with the VPS tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  VPS </a><a href="/archive/tag/vps/" aria-label="View all posts with the vps tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  vps </a><a href="/archive/tag/x-wrt/" aria-label="View all posts with the x-wrt tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  x-wrt </a><a href="/archive/tag/X-WRT/" aria-label="View all posts with the X-WRT tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  X-WRT </a><a href="/archive/tag/多拨/" aria-label="View all posts with the 多拨 tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  多拨 </a><a href="/archive/tag/技术分享/" aria-label="View all posts with the 技术分享 tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  技术分享 </a><a href="/archive/tag/技术分享、/" aria-label="View all posts with the 技术分享、 tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  技术分享、 </a><a href="/archive/tag/教程/" aria-label="View all posts with the 教程 tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  教程 </a><a href="/archive/tag/编译/" aria-label="View all posts with the 编译 tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  编译 </a><a href="/archive/tag/网络/" aria-label="View all posts with the 网络 tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  网络 </a><a href="/archive/tag/负载均衡/" aria-label="View all posts with the 负载均衡 tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  负载均衡 </a><a href="/archive/tag/路由器/" aria-label="View all posts with the 路由器 tag" class="btn-regular h-8 text-sm px-3 rounded-lg">  路由器 </a> </div>  </div>  </widget-layout>  <script type="module">class d extends HTMLElement{constructor(){if(super(),this.dataset.isCollapsed!=="true")return;const e=this.dataset.id,t=this.querySelector(".expand-btn"),s=this.querySelector(`#${e}`);t.addEventListener("click",()=>{s.classList.remove("collapsed"),t.classList.add("hidden")})}}customElements.get("widget-layout")||customElements.define("widget-layout",d);</script> <widget-layout data-id="todo-list" data-is-collapsed="undefined" class="pb-4 card-base onload-animation" style="animation-delay: 250ms; " data-astro-cid-ucso7hve="true"> <div class="font-bold transition text-lg text-neutral-900 dark:text-neutral-100 relative ml-8 mt-4 mb-2
        before:w-1 before:h-4 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:left-[-16px] before:top-[5.5px]" data-astro-cid-ucso7hve style="">待办事项</div> <div id="todo-list" class="collapse-wrapper px-4 overflow-hidden" data-astro-cid-ucso7hve style=""> <div class="flex flex-col gap-2"><div class="flex items-center gap-2 text-sm text-neutral-700 dark:text-neutral-300"><svg width="1em" height="1em" class="text-lg flex-shrink-0 text-[var(--primary)]" data-icon="material-symbols:check-box-outline">   <symbol id="ai:material-symbols:check-box-outline" viewBox="0 0 24 24"><path fill="currentColor" d="m10.6 16.2l7.05-7.05l-1.4-1.4l-5.65 5.65l-2.85-2.85l-1.4 1.4zM5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5H5zM5 5v14z"/></symbol><use href="#ai:material-symbols:check-box-outline"></use>  </svg><span class="line-through opacity-60">完成博客迁移</span></div></div><div class="mt-4 flex justify-center"><a href="https://github.com/qc3284/afo-fuwari/tree/main/src/data/todo.ts" target="_blank" rel="noopener noreferrer" class="btn-plain rounded-lg h-9 px-4 flex items-center gap-2 text-[var(--primary)] text-sm"><svg width="1em" height="1em" class="text-lg" data-icon="material-symbols:add-task-rounded">   <symbol id="ai:material-symbols:add-task-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2q1.2 0 2.338.275t2.187.8q.375.2.488.6t-.138.75t-.663.45t-.812-.1q-.8-.375-1.663-.575T12 4Q8.65 4 6.325 6.325T4 12t2.325 5.675T12 20q.65 0 1.275-.1t1.25-.3q.425-.125.825-.012t.625.487q.2.35.087.75t-.512.55q-.85.325-1.75.475T12 22m7-5h-2q-.425 0-.712-.288T16 16t.288-.712T17 15h2v-2q0-.425.288-.712T20 12t.713.288T21 13v2h2q.425 0 .713.288T24 16t-.288.713T23 17h-2v2q0 .425-.288.713T20 20t-.712-.288T19 19zm-8.4-3.2l9.3-9.325q.275-.275.7-.275t.7.275t.275.7t-.275.7L11.3 15.9q-.3.3-.7.3t-.7-.3l-2.85-2.85q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275z"/></symbol><use href="#ai:material-symbols:add-task-rounded"></use>  </svg>
我要给你加工作！
</a></div> </div>  </widget-layout>   <widget-layout data-id="time-card" data-is-collapsed="undefined" class="pb-4 card-base onload-animation" style="animation-delay: 300ms; " data-astro-cid-ucso7hve="true"> <div class="font-bold transition text-lg text-neutral-900 dark:text-neutral-100 relative ml-8 mt-4 mb-2
        before:w-1 before:h-4 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:left-[-16px] before:top-[5.5px]" data-astro-cid-ucso7hve style="">时光流逝</div> <div id="time-card" class="collapse-wrapper px-4 overflow-hidden" data-astro-cid-ucso7hve style="">  <div class="flex flex-col gap-3 text-sm"> <div id="current-date-text" class="text-center font-bold text-neutral-700 dark:text-neutral-300 mb-1">
加载中...
</div> <div class="flex flex-col gap-1"> <div class="flex justify-between items-center text-xs text-neutral-500"> <span>今天已过去</span> <span id="day-progress-text">0.00000%</span> </div> <div class="w-full bg-neutral-200 dark:bg-neutral-700 rounded-full h-2.5 overflow-hidden"> <div id="day-progress-bar" class="h-2.5 rounded-full bg-blue-500 transition-all duration-500" style="width: 0%"></div> </div> </div> <div class="flex flex-col gap-1"> <div class="flex justify-between items-center text-xs text-neutral-500"> <span>本周已过去</span> <span id="week-progress-text">0.00000%</span> </div> <div class="w-full bg-neutral-200 dark:bg-neutral-700 rounded-full h-2.5 overflow-hidden"> <div id="week-progress-bar" class="h-2.5 rounded-full bg-green-500 transition-all duration-500" style="width: 0%"></div> </div> </div> <div class="flex flex-col gap-1"> <div class="flex justify-between items-center text-xs text-neutral-500"> <span>本月已过去</span> <span id="month-progress-text">0.00000%</span> </div> <div class="w-full bg-neutral-200 dark:bg-neutral-700 rounded-full h-2.5 overflow-hidden"> <div id="month-progress-bar" class="h-2.5 rounded-full bg-yellow-500 transition-all duration-500" style="width: 0%"></div> </div> </div> <div class="flex flex-col gap-1"> <div class="flex justify-between items-center text-xs text-neutral-500"> <span>今年已过去</span> <span id="year-progress-text">0.00000%</span> </div> <div class="w-full bg-neutral-200 dark:bg-neutral-700 rounded-full h-2.5 overflow-hidden"> <div id="year-progress-bar" class="h-2.5 rounded-full bg-red-500 transition-all duration-500" style="width: 0%"></div> </div> </div> <div class="flex flex-col gap-1"> <div class="flex justify-between items-center text-xs text-neutral-500"> <span>站长人生已过去</span> <span id="life-progress-text">0.00000%</span> </div> <div class="w-full bg-neutral-200 dark:bg-neutral-700 rounded-full h-2.5 overflow-hidden"> <div id="life-progress-bar" class="h-2.5 rounded-full bg-purple-500 transition-all duration-500" style="width: 0%"></div> </div> </div> </div>  </div>  </widget-layout>   <script type="module">function a(){const e=new Date,T=e.getFullYear(),y=String(e.getMonth()+1).padStart(2,"0"),u=String(e.getDate()).padStart(2,"0"),w=["日","一","二","三","四","五","六"][e.getDay()],h=String(e.getHours()).padStart(2,"0"),f=String(e.getMinutes()).padStart(2,"0"),p=String(e.getSeconds()).padStart(2,"0"),s=document.getElementById("current-date-text");s&&(s.textContent=`今天是 ${T}年${y}月${u}日 星期${w} ${h}:${f}:${p}`);const o=new Date(e.getFullYear(),e.getMonth(),e.getDate()),M=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1),S=(e.getTime()-o.getTime())/(M.getTime()-o.getTime())*100;e.getDay();const t=new Date(e),$=(e.getDay()+6)%7;t.setDate(e.getDate()-$),t.setHours(0,0,0,0);const g=new Date(t);g.setDate(t.getDate()+7);const Y=(e.getTime()-t.getTime())/(g.getTime()-t.getTime())*100,r=new Date(e.getFullYear(),e.getMonth(),1);new Date(e.getFullYear(),e.getMonth()+1,0,23,59,59,999);const k=new Date(e.getFullYear(),e.getMonth()+1,1),x=(e.getTime()-r.getTime())/(k.getTime()-r.getTime())*100,c=new Date(e.getFullYear(),0,1),F=new Date(e.getFullYear()+1,0,1),O=(e.getTime()-c.getTime())/(F.getTime()-c.getTime())*100,i=new Date("2007-09-20T00:00:00"),E=new Date("2107-09-20T00:00:00"),B=Math.max(0,Math.min(100,(e.getTime()-i.getTime())/(E.getTime()-i.getTime())*100)),n=(m,d)=>{const D=document.getElementById(`${m}-text`),l=document.getElementById(`${m}-bar`);D&&(D.textContent=`${d.toFixed(5)}%`),l&&(l.style.width=`${d}%`)};n("day-progress",S),n("week-progress",Y),n("month-progress",x),n("year-progress",O),n("life-progress",B)}a();setInterval(a,100);document.addEventListener("astro:page-load",()=>{a()});</script> </div> </div> <main id="swup-container" class="transition-swup-fade col-span-2 lg:col-span-1 overflow-hidden"> <div id="content-wrapper" class="onload-animation"> <!-- the overflow-hidden here prevent long text break the layout--> <!-- make id different from windows.swup global property -->  <div class="transition flex flex-col rounded-[var(--radius-large)] bg-transparent py-1 md:py-0 md:gap-4 mb-4"> <div class="card-base flex flex-col-reverse md:flex-col w-full rounded-[var(--radius-large)] overflow-hidden relative onload-animation" style="animation-delay: calc(var(--content-delay) + 0ms);; --coverWidth: 28%;" data-astro-cid-iyiqi2so> <div class="pl-6 md:pl-9 pr-6 md:pr-2 pt-6 md:pt-7 pb-6 relative w-full md:w-[calc(100%_-_var(--coverWidth)_-_12px)]" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <a href="/posts/x-wrt-ssh-open/" class="transition group w-full block font-bold mb-3 text-3xl text-90
        hover:text-[var(--primary)] dark:hover:text-[var(--primary)]
        active:text-[var(--title-active)] dark:active:text-[var(--title-active)]
        before:w-1 before:h-5 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:top-[35px] before:left-[18px] before:hidden md:before:block
        " data-astro-cid-iyiqi2so style="--coverWidth: 28%;">  X-wrt SSH Open <svg width="1em" height="1em" viewBox="0 0 24 24" class="inline text-[2rem] text-[var(--primary)] md:hidden translate-y-0.5 absolute" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-[var(--primary)] text-[2rem] transition hidden md:inline absolute translate-y-0.5 opacity-0 group-hover:opacity-100 -translate-x-1 group-hover:translate-x-0" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </a> <!-- metadata --> <div class="flex flex-wrap text-neutral-500 dark:text-neutral-400 items-center gap-4 gap-x-4 gap-y-2 mb-4"> <!-- publish date --> <div class="flex items-center"> <div class="meta-icon"> <svg width="1em" height="1em" class="text-xl" data-icon="material-symbols:calendar-today-outline-rounded">   <symbol id="ai:material-symbols:calendar-today-outline-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="M5 22q-.825 0-1.412-.587T3 20V6q0-.825.588-1.412T5 4h1V3q0-.425.288-.712T7 2t.713.288T8 3v1h8V3q0-.425.288-.712T17 2t.713.288T18 3v1h1q.825 0 1.413.588T21 6v14q0 .825-.587 1.413T19 22zm0-2h14V10H5zM5 8h14V6H5zm0 0V6z"/></symbol><use href="#ai:material-symbols:calendar-today-outline-rounded"></use>  </svg> </div> <span class="text-50 text-sm font-medium">2024-08-09</span> </div> <!-- update date -->  <!-- tags --> <div class="items-center hidden md:flex"> <div class="meta-icon"> <svg width="1em" height="1em" class="text-xl" data-icon="material-symbols:tag-rounded">   <symbol id="ai:material-symbols:tag-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="m9 16l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T6.3 18.8L7 16H4.275q-.5 0-.8-.387T3.3 14.75q.075-.35.35-.55t.625-.2H7.5l1-4H5.775q-.5 0-.8-.387T4.8 8.75q.075-.35.35-.55t.625-.2H9l.825-3.275Q9.9 4.4 10.15 4.2t.6-.2q.475 0 .775.375t.175.825L11 8h4l.825-3.275q.075-.325.325-.525t.6-.2q.475 0 .775.375t.175.825L17 8h2.725q.5 0 .8.387t.175.863q-.075.35-.35.55t-.625.2H16.5l-1 4h2.725q.5 0 .8.388t.175.862q-.075.35-.35.55t-.625.2H15l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T12.3 18.8L13 16zm.5-2h4l1-4h-4z"/></symbol><use href="#ai:material-symbols:tag-rounded"></use>  </svg> </div> <div class="flex flex-row flex-nowrap items-center"> <div class="hidden mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/x-wrt/" aria-label="View all posts with the x-wrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> x-wrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/X-WRT/" aria-label="View all posts with the X-WRT tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> X-WRT </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/openwrt/" aria-label="View all posts with the openwrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> openwrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/SSH/" aria-label="View all posts with the SSH tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> SSH </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/ssh/" aria-label="View all posts with the ssh tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> ssh </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/教程/" aria-label="View all posts with the 教程 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 教程 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/技术分享/" aria-label="View all posts with the 技术分享 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 技术分享 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/网络/" aria-label="View all posts with the 网络 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 网络 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/路由器/" aria-label="View all posts with the 路由器 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 路由器 </a>  </div> </div> <!-- page views & visitors -->  </div>  <!-- description --> <div class="transition text-75 mb-3.5 pr-4" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> 如何开启X-wrt的SSH </div> <!-- word count, read time and page views --> <div class="text-sm text-black/30 dark:text-white/30 flex gap-4 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">120 字</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">1 分钟</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div class="flex items-center gap-2" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:visibility-outline">   <use href="#ai:material-symbols:visibility-outline"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-views-x-wrt-ssh-open" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:person">   <use href="#ai:material-symbols:person"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-visitors-x-wrt-ssh-open" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> </div> </div> </div> <a href="/posts/x-wrt-ssh-open/" aria-label="X-wrt SSH Open" class="group max-h-[20vh] md:max-h-none mx-4 mt-4 -mb-2 md:mb-0 md:mx-0 md:mt-0 md:w-[var(--coverWidth)] relative md:absolute md:top-3 md:bottom-3 md:right-3 rounded-xl overflow-hidden active:scale-95" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="absolute pointer-events-none z-10 w-full h-full group-hover:bg-black/30 group-active:bg-black/50 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <!-- 封面图上的箭头 --> <div class="absolute pointer-events-none z-20 w-full h-full flex items-center justify-center " data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition opacity-0 group-hover:opacity-100 scale-50 group-hover:scale-100 text-white text-5xl" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </div> <div class="w-full h-full overflow-hidden relative image-wrapper" style="--theme-hue: 215" data-astro-cid-i2xmscho> <!-- 加载条 --> <div class="loading-bar absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-1 bg-gray-200 dark:bg-gray-700 z-10 rounded-full overflow-hidden" data-astro-cid-i2xmscho> <div class="loading-progress h-full w-8 bg-[oklch(0.70_0.14_var(--theme-hue))] animate-loading-progress rounded-full" data-astro-cid-i2xmscho></div> </div> <!-- 图片内容 --> <img src="/_astro/x-wrt-logo-min.CVnPatDP_19DKCs.svg" alt="Cover Image of the Post" style="object-position: center" onload="this.style.opacity='1'; this.parentElement.querySelector('.loading-bar').style.opacity='0';" data-astro-cid-i2xmscho="true" width="147" height="147" loading="lazy" decoding="async" class="w-full h-full object-cover image-content opacity-0 transition-opacity duration-500">  </div>  </a>  </div> <div class="transition border-t-[1px] border-dashed mx-6 border-black/10 dark:border-white/[0.15] last:border-t-0 md:hidden" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <script>(function(){const entry = {"id":"x-wrt ssh open.md","data":{"title":"X-wrt SSH Open","published":"2024-08-09T00:00:00.000Z","description":"如何开启X-wrt的SSH","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","SSH","ssh","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":1,"words":120,"excerpt":"文章来源：https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/ssh-open","prevSlug":"x-wrt-duobo","prevTitle":"X-wrt 多拨和负载均衡"},"body":"文章来源：https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/ssh-open\n\n# X-WRT 开启ssh的方法\n\n很多⼈说 X-WRT 的ssh无法登录，这其实是因为默认的ssh没有开启用户登录，大家可以进入界面，进入[系统-管理权](#)页面，进入[SSH访问](#)标签，开启**密码验证**和**允许 root 用户凭密码登录**就可以了。\n\n![](https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/ssh-open/ssh1.png)\n\n**注意请使用谷歌浏览器，火狐浏览器，微软的浏览器，其他浏览器存在不可预知的问题。**","filePath":"src/content/posts/x-wrt ssh open.md","digest":"229d28d7cf050702","rendered":{"html":"<p>文章来源：<a href=\"https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/ssh-open\" rel=\"nofollow\" target=\"_blank\">https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/ssh-open</a></p>\n<section><h1 id=\"x-wrt-开启ssh的方法\">X-WRT 开启ssh的方法<a class=\"anchor\" href=\"#x-wrt-开启ssh的方法\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h1><p>很多⼈说 X-WRT 的ssh无法登录，这其实是因为默认的ssh没有开启用户登录，大家可以进入界面，进入<a href=\"#\">系统-管理权</a>页面，进入<a href=\"#\">SSH访问</a>标签，开启<strong>密码验证</strong>和<strong>允许 root 用户凭密码登录</strong>就可以了。</p><p><img src=\"https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/ssh-open/ssh1.png\" alt=\"\"></p><p><strong>注意请使用谷歌浏览器，火狐浏览器，微软的浏览器，其他浏览器存在不可预知的问题。</strong></p></section>","metadata":{"headings":[{"depth":1,"slug":"x-wrt-开启ssh的方法","text":"X-WRT 开启ssh的方法#"}],"localImagePaths":[],"remoteImagePaths":[],"frontmatter":{"title":"X-wrt SSH Open","published":"2024-08-09T00:00:00.000Z","description":"如何开启X-wrt的SSH","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","SSH","ssh","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":1,"words":120,"excerpt":"文章来源：https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/ssh-open"},"imagePaths":[]}},"collection":"posts","slug":"x-wrt-ssh-open"};
const umamiConfig = {"enable":false,"baseUrl":"","shareId":"","timezone":"Asia/Shanghai"};

    // 获取文章浏览量统计
    async function fetchPostCardViews(slug) {
        if (!umamiConfig.enable) {
            return;
        }
        
        try {
            // 调用全局工具获取 Umami 分享数据
            const { websiteId, token } = await getUmamiShareData(umamiConfig.baseUrl, umamiConfig.shareId);
            
            // 第二步：获取统计数据
            const currentTimestamp = Date.now();
            const statsUrl = `${umamiConfig.baseUrl}/api/websites/${websiteId}/stats?startAt=0&endAt=${currentTimestamp}&unit=hour&timezone=${encodeURIComponent(umamiConfig.timezone)}&path=eq.%2Fposts%2F${slug}%2F&compare=false`;
            
            const statsResponse = await fetch(statsUrl, {
                headers: {
                    'x-umami-share-token': token
                }
            });
            
            if (statsResponse.status === 401) {
                clearUmamiShareCache();
                return await fetchPostCardViews(slug);
            }
            
            if (!statsResponse.ok) {
                throw new Error('获取统计数据失败');
            }
            
            const statsData = await statsResponse.json();
            const pageViews = statsData.pageviews || 0;
            const visits = statsData.visitors || 0;
            
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
             if (viewsElement) {
                 viewsElement.textContent = pageViews;
             }
             if (visitorsElement) {
                 visitorsElement.textContent = visits;
             }
        } catch (error) {
            console.error('Error fetching page views for', slug, ':', error);
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
            if (viewsElement) {
                viewsElement.textContent = '-';
            }
            if (visitorsElement) {
                visitorsElement.textContent = '-';
            }
        }
    }

    // 页面加载完成后获取统计数据
    function initPostCardStats() {
        const slug = entry.slug;
        if (slug) {
            fetchPostCardViews(slug);
        }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initPostCardStats);
    } else {
        initPostCardStats();
    }
})();</script> <div class="card-base flex flex-col-reverse md:flex-col w-full rounded-[var(--radius-large)] overflow-hidden relative onload-animation" style="animation-delay: calc(var(--content-delay) + 50ms);; --coverWidth: 28%;" data-astro-cid-iyiqi2so> <div class="pl-6 md:pl-9 pr-6 md:pr-2 pt-6 md:pt-7 pb-6 relative w-full md:w-[calc(100%_-_var(--coverWidth)_-_12px)]" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <a href="/posts/x-wrt-duobo/" class="transition group w-full block font-bold mb-3 text-3xl text-90
        hover:text-[var(--primary)] dark:hover:text-[var(--primary)]
        active:text-[var(--title-active)] dark:active:text-[var(--title-active)]
        before:w-1 before:h-5 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:top-[35px] before:left-[18px] before:hidden md:before:block
        " data-astro-cid-iyiqi2so style="--coverWidth: 28%;">  X-wrt 多拨和负载均衡 <svg width="1em" height="1em" viewBox="0 0 24 24" class="inline text-[2rem] text-[var(--primary)] md:hidden translate-y-0.5 absolute" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-[var(--primary)] text-[2rem] transition hidden md:inline absolute translate-y-0.5 opacity-0 group-hover:opacity-100 -translate-x-1 group-hover:translate-x-0" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </a> <!-- metadata --> <div class="flex flex-wrap text-neutral-500 dark:text-neutral-400 items-center gap-4 gap-x-4 gap-y-2 mb-4"> <!-- publish date --> <div class="flex items-center"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:calendar-today-outline-rounded">   <use href="#ai:material-symbols:calendar-today-outline-rounded"></use>  </svg> </div> <span class="text-50 text-sm font-medium">2024-08-09</span> </div> <!-- update date -->  <!-- tags --> <div class="items-center hidden md:flex"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:tag-rounded">   <use href="#ai:material-symbols:tag-rounded"></use>  </svg> </div> <div class="flex flex-row flex-nowrap items-center"> <div class="hidden mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/x-wrt/" aria-label="View all posts with the x-wrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> x-wrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/X-WRT/" aria-label="View all posts with the X-WRT tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> X-WRT </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/openwrt/" aria-label="View all posts with the openwrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> openwrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/负载均衡/" aria-label="View all posts with the 负载均衡 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 负载均衡 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/多拨/" aria-label="View all posts with the 多拨 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 多拨 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/教程/" aria-label="View all posts with the 教程 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 教程 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/技术分享/" aria-label="View all posts with the 技术分享 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 技术分享 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/网络/" aria-label="View all posts with the 网络 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 网络 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/路由器/" aria-label="View all posts with the 路由器 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 路由器 </a>  </div> </div> <!-- page views & visitors -->  </div>  <!-- description --> <div class="transition text-75 mb-3.5 pr-4" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> X-wrt 多拨和负载均衡教程 </div> <!-- word count, read time and page views --> <div class="text-sm text-black/30 dark:text-white/30 flex gap-4 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">305 字</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">2 分钟</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div class="flex items-center gap-2" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:visibility-outline">   <use href="#ai:material-symbols:visibility-outline"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-views-x-wrt-duobo" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:person">   <use href="#ai:material-symbols:person"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-visitors-x-wrt-duobo" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> </div> </div> </div> <a href="/posts/x-wrt-duobo/" aria-label="X-wrt 多拨和负载均衡" class="group max-h-[20vh] md:max-h-none mx-4 mt-4 -mb-2 md:mb-0 md:mx-0 md:mt-0 md:w-[var(--coverWidth)] relative md:absolute md:top-3 md:bottom-3 md:right-3 rounded-xl overflow-hidden active:scale-95" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="absolute pointer-events-none z-10 w-full h-full group-hover:bg-black/30 group-active:bg-black/50 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <!-- 封面图上的箭头 --> <div class="absolute pointer-events-none z-20 w-full h-full flex items-center justify-center " data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition opacity-0 group-hover:opacity-100 scale-50 group-hover:scale-100 text-white text-5xl" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </div> <div class="w-full h-full overflow-hidden relative image-wrapper" style="--theme-hue: 215" data-astro-cid-i2xmscho> <!-- 加载条 --> <div class="loading-bar absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-1 bg-gray-200 dark:bg-gray-700 z-10 rounded-full overflow-hidden" data-astro-cid-i2xmscho> <div class="loading-progress h-full w-8 bg-[oklch(0.70_0.14_var(--theme-hue))] animate-loading-progress rounded-full" data-astro-cid-i2xmscho></div> </div> <!-- 图片内容 --> <img src="/_astro/x-wrt-logo-min.CVnPatDP_19DKCs.svg" alt="Cover Image of the Post" style="object-position: center" onload="this.style.opacity='1'; this.parentElement.querySelector('.loading-bar').style.opacity='0';" data-astro-cid-i2xmscho="true" width="147" height="147" loading="lazy" decoding="async" class="w-full h-full object-cover image-content opacity-0 transition-opacity duration-500">  </div>  </a>  </div> <div class="transition border-t-[1px] border-dashed mx-6 border-black/10 dark:border-white/[0.15] last:border-t-0 md:hidden" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <script>(function(){const entry = {"id":"x-wrt-duobo.md","data":{"title":"X-wrt 多拨和负载均衡","published":"2024-08-09T00:00:00.000Z","description":"X-wrt 多拨和负载均衡教程","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","负载均衡","多拨","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":2,"words":305,"excerpt":"文章来源：https://github.com/x-wrt/x-wrt.github.io/master/docs/xwan/","nextSlug":"x-wrt-ssh-open","nextTitle":"X-wrt SSH Open","prevSlug":"x-wrt-luci-app-fakemesh","prevTitle":"X-wrt luci-app-fakemesh"},"body":"文章来源：https://github.com/x-wrt/x-wrt.github.io/master/docs/xwan/\n\n# 多拨和负载均衡配置教程\n\n## 1. 介绍(单网口多拨)\n很多⼈不知道怎么配置OpenWrt多拨，特写⼀个简易的教程，只要你的运营商⽀持多拨，照着这个教程做都可以多拨叠加⽹速。本教程适用于OpenWrt衍生版本[X-WRT的固件](https://downloads.x-wrt.com/rom/)。\n\n**注意请使用谷歌浏览器，火狐浏览器，微软的浏览器，其他浏览器存在不可预知的问题。**\n\n### 1.1 首先，正常设置好wan口拨号上网\n在[网络-接口](#)页面，编辑[wan口-基本设置](#)，选择协议PPPoE，填写宽带账户密码:\n![](https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/xwan/xwan-pppoe1.png)\n\n修改[wan口-高级设置](#)，使用网关跃点 填写`40`，[防火墙设置](#) 选择wan\n![](https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/xwan/xwan-pppoe2.png)\n\n### 1.2 然后，开启多拨\n进入[网络-多拨](#)页面，开启多拨，填写想要的多拨数，启用自动负载均衡和叠加:\n![](https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/xwan/xwan1.png)\n\n开启多拨后，它会自动设置好负载均衡和叠加，对于高级用户，可以进入[网络-负载均衡](#)页面进行高级的调整，小白用户可以忽略。\n\n**PS: 这里开启多拨，实际上用的网口就是1.1设置的wan口的接口**","filePath":"src/content/posts/x-wrt-duobo.md","digest":"cbd3e9aaf03c80d7","rendered":{"html":"<p>文章来源：<a href=\"https://github.com/x-wrt/x-wrt.github.io/master/docs/xwan/\" rel=\"nofollow\" target=\"_blank\">https://github.com/x-wrt/x-wrt.github.io/master/docs/xwan/</a></p>\n<section><h1 id=\"多拨和负载均衡配置教程\">多拨和负载均衡配置教程<a class=\"anchor\" href=\"#多拨和负载均衡配置教程\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h1><section><h2 id=\"1-介绍单网口多拨\">1. 介绍(单网口多拨)<a class=\"anchor\" href=\"#1-介绍单网口多拨\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>很多⼈不知道怎么配置OpenWrt多拨，特写⼀个简易的教程，只要你的运营商⽀持多拨，照着这个教程做都可以多拨叠加⽹速。本教程适用于OpenWrt衍生版本<a href=\"https://downloads.x-wrt.com/rom/\" rel=\"nofollow\" target=\"_blank\">X-WRT的固件</a>。</p><p><strong>注意请使用谷歌浏览器，火狐浏览器，微软的浏览器，其他浏览器存在不可预知的问题。</strong></p><section><h3 id=\"11-首先正常设置好wan口拨号上网\">1.1 首先，正常设置好wan口拨号上网<a class=\"anchor\" href=\"#11-首先正常设置好wan口拨号上网\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>在<a href=\"#\">网络-接口</a>页面，编辑<a href=\"#\">wan口-基本设置</a>，选择协议PPPoE，填写宽带账户密码:\n<img src=\"https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/xwan/xwan-pppoe1.png\" alt=\"\"></p><p>修改<a href=\"#\">wan口-高级设置</a>，使用网关跃点 填写<code>40</code>，<a href=\"#\">防火墙设置</a> 选择wan\n<img src=\"https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/xwan/xwan-pppoe2.png\" alt=\"\"></p></section><section><h3 id=\"12-然后开启多拨\">1.2 然后，开启多拨<a class=\"anchor\" href=\"#12-然后开启多拨\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>进入<a href=\"#\">网络-多拨</a>页面，开启多拨，填写想要的多拨数，启用自动负载均衡和叠加:\n<img src=\"https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/xwan/xwan1.png\" alt=\"\"></p><p>开启多拨后，它会自动设置好负载均衡和叠加，对于高级用户，可以进入<a href=\"#\">网络-负载均衡</a>页面进行高级的调整，小白用户可以忽略。</p><p><strong>PS: 这里开启多拨，实际上用的网口就是1.1设置的wan口的接口</strong></p></section></section></section>","metadata":{"headings":[{"depth":1,"slug":"多拨和负载均衡配置教程","text":"多拨和负载均衡配置教程#"},{"depth":2,"slug":"1-介绍单网口多拨","text":"1. 介绍(单网口多拨)#"},{"depth":3,"slug":"11-首先正常设置好wan口拨号上网","text":"1.1 首先，正常设置好wan口拨号上网#"},{"depth":3,"slug":"12-然后开启多拨","text":"1.2 然后，开启多拨#"}],"localImagePaths":[],"remoteImagePaths":[],"frontmatter":{"title":"X-wrt 多拨和负载均衡","published":"2024-08-09T00:00:00.000Z","description":"X-wrt 多拨和负载均衡教程","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","负载均衡","多拨","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":2,"words":305,"excerpt":"文章来源：https://github.com/x-wrt/x-wrt.github.io/master/docs/xwan/"},"imagePaths":[]}},"collection":"posts","slug":"x-wrt-duobo"};
const umamiConfig = {"enable":false,"baseUrl":"","shareId":"","timezone":"Asia/Shanghai"};

    // 获取文章浏览量统计
    async function fetchPostCardViews(slug) {
        if (!umamiConfig.enable) {
            return;
        }
        
        try {
            // 调用全局工具获取 Umami 分享数据
            const { websiteId, token } = await getUmamiShareData(umamiConfig.baseUrl, umamiConfig.shareId);
            
            // 第二步：获取统计数据
            const currentTimestamp = Date.now();
            const statsUrl = `${umamiConfig.baseUrl}/api/websites/${websiteId}/stats?startAt=0&endAt=${currentTimestamp}&unit=hour&timezone=${encodeURIComponent(umamiConfig.timezone)}&path=eq.%2Fposts%2F${slug}%2F&compare=false`;
            
            const statsResponse = await fetch(statsUrl, {
                headers: {
                    'x-umami-share-token': token
                }
            });
            
            if (statsResponse.status === 401) {
                clearUmamiShareCache();
                return await fetchPostCardViews(slug);
            }
            
            if (!statsResponse.ok) {
                throw new Error('获取统计数据失败');
            }
            
            const statsData = await statsResponse.json();
            const pageViews = statsData.pageviews || 0;
            const visits = statsData.visitors || 0;
            
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
             if (viewsElement) {
                 viewsElement.textContent = pageViews;
             }
             if (visitorsElement) {
                 visitorsElement.textContent = visits;
             }
        } catch (error) {
            console.error('Error fetching page views for', slug, ':', error);
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
            if (viewsElement) {
                viewsElement.textContent = '-';
            }
            if (visitorsElement) {
                visitorsElement.textContent = '-';
            }
        }
    }

    // 页面加载完成后获取统计数据
    function initPostCardStats() {
        const slug = entry.slug;
        if (slug) {
            fetchPostCardViews(slug);
        }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initPostCardStats);
    } else {
        initPostCardStats();
    }
})();</script> <div class="card-base flex flex-col-reverse md:flex-col w-full rounded-[var(--radius-large)] overflow-hidden relative onload-animation" style="animation-delay: calc(var(--content-delay) + 100ms);; --coverWidth: 28%;" data-astro-cid-iyiqi2so> <div class="pl-6 md:pl-9 pr-6 md:pr-2 pt-6 md:pt-7 pb-6 relative w-full md:w-[calc(100%_-_var(--coverWidth)_-_12px)]" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <a href="/posts/x-wrt-luci-app-fakemesh/" class="transition group w-full block font-bold mb-3 text-3xl text-90
        hover:text-[var(--primary)] dark:hover:text-[var(--primary)]
        active:text-[var(--title-active)] dark:active:text-[var(--title-active)]
        before:w-1 before:h-5 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:top-[35px] before:left-[18px] before:hidden md:before:block
        " data-astro-cid-iyiqi2so style="--coverWidth: 28%;">  X-wrt luci-app-fakemesh <svg width="1em" height="1em" viewBox="0 0 24 24" class="inline text-[2rem] text-[var(--primary)] md:hidden translate-y-0.5 absolute" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-[var(--primary)] text-[2rem] transition hidden md:inline absolute translate-y-0.5 opacity-0 group-hover:opacity-100 -translate-x-1 group-hover:translate-x-0" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </a> <!-- metadata --> <div class="flex flex-wrap text-neutral-500 dark:text-neutral-400 items-center gap-4 gap-x-4 gap-y-2 mb-4"> <!-- publish date --> <div class="flex items-center"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:calendar-today-outline-rounded">   <use href="#ai:material-symbols:calendar-today-outline-rounded"></use>  </svg> </div> <span class="text-50 text-sm font-medium">2024-08-09</span> </div> <!-- update date -->  <!-- tags --> <div class="items-center hidden md:flex"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:tag-rounded">   <use href="#ai:material-symbols:tag-rounded"></use>  </svg> </div> <div class="flex flex-row flex-nowrap items-center"> <div class="hidden mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/x-wrt/" aria-label="View all posts with the x-wrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> x-wrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/X-WRT/" aria-label="View all posts with the X-WRT tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> X-WRT </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/openwrt/" aria-label="View all posts with the openwrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> openwrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/mesh/" aria-label="View all posts with the mesh tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> mesh </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/luci-app-fakemesh/" aria-label="View all posts with the luci-app-fakemesh tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> luci-app-fakemesh </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/教程/" aria-label="View all posts with the 教程 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 教程 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/技术分享/" aria-label="View all posts with the 技术分享 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 技术分享 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/网络/" aria-label="View all posts with the 网络 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 网络 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/路由器/" aria-label="View all posts with the 路由器 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 路由器 </a>  </div> </div> <!-- page views & visitors -->  </div>  <!-- description --> <div class="transition text-75 mb-3.5 pr-4" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> X-wrt luci-app-fakemesh介绍及使用教程 </div> <!-- word count, read time and page views --> <div class="text-sm text-black/30 dark:text-white/30 flex gap-4 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">906 字</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">5 分钟</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div class="flex items-center gap-2" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:visibility-outline">   <use href="#ai:material-symbols:visibility-outline"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-views-x-wrt-luci-app-fakemesh" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:person">   <use href="#ai:material-symbols:person"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-visitors-x-wrt-luci-app-fakemesh" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> </div> </div> </div> <a href="/posts/x-wrt-luci-app-fakemesh/" aria-label="X-wrt luci-app-fakemesh" class="group max-h-[20vh] md:max-h-none mx-4 mt-4 -mb-2 md:mb-0 md:mx-0 md:mt-0 md:w-[var(--coverWidth)] relative md:absolute md:top-3 md:bottom-3 md:right-3 rounded-xl overflow-hidden active:scale-95" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="absolute pointer-events-none z-10 w-full h-full group-hover:bg-black/30 group-active:bg-black/50 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <!-- 封面图上的箭头 --> <div class="absolute pointer-events-none z-20 w-full h-full flex items-center justify-center " data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition opacity-0 group-hover:opacity-100 scale-50 group-hover:scale-100 text-white text-5xl" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </div> <div class="w-full h-full overflow-hidden relative image-wrapper" style="--theme-hue: 215" data-astro-cid-i2xmscho> <!-- 加载条 --> <div class="loading-bar absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-1 bg-gray-200 dark:bg-gray-700 z-10 rounded-full overflow-hidden" data-astro-cid-i2xmscho> <div class="loading-progress h-full w-8 bg-[oklch(0.70_0.14_var(--theme-hue))] animate-loading-progress rounded-full" data-astro-cid-i2xmscho></div> </div> <!-- 图片内容 --> <img src="/_astro/x-wrt-logo-min.CVnPatDP_19DKCs.svg" alt="Cover Image of the Post" style="object-position: center" onload="this.style.opacity='1'; this.parentElement.querySelector('.loading-bar').style.opacity='0';" data-astro-cid-i2xmscho="true" width="147" height="147" loading="lazy" decoding="async" class="w-full h-full object-cover image-content opacity-0 transition-opacity duration-500">  </div>  </a>  </div> <div class="transition border-t-[1px] border-dashed mx-6 border-black/10 dark:border-white/[0.15] last:border-t-0 md:hidden" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <script>(function(){const entry = {"id":"x-wrt luci-app-fakemesh.md","data":{"title":"X-wrt luci-app-fakemesh","published":"2024-08-09T00:00:00.000Z","description":"X-wrt luci-app-fakemesh介绍及使用教程","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","mesh","luci-app-fakemesh","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":5,"words":906,"excerpt":"文章来源：https://github.com/x-wrt/com.x-wrt/tree/master/luci-app-fakemesh","nextSlug":"x-wrt-duobo","nextTitle":"X-wrt 多拨和负载均衡","prevSlug":"x-wrt-install-on-vps2","prevTitle":"X-wrt install on vps"},"body":"文章来源：https://github.com/x-wrt/com.x-wrt/tree/master/luci-app-fakemesh\n\n## fakemesh简介\n\nfakemesh是一种网络拓扑结构，由一个`控制器（AC）`和一个或多个`有线AP（Wired AP）`和`卫星（Agent）`组成。它是一种混合了`无线Mesh`和`AC+AP`两种组网模式的混合网络，其中，`有线AP`通过网线和`控制器（AC）`相连，而`卫星（Agent）`则通过无线STA方式接入，共同构成一个无线（包括有线）覆盖网络。\n\nfakemesh的部署确实相对较为方便，只需要将节点设备连接到正确的网络，并设置节点设备的角色，Mesh ID等信息即可。因为fakemesh结合了无线Mesh和AC+AP两种组网模式，所以也可以很方便地进行混合组网，提高了网络的覆盖范围和可靠性。\n\n目前[X-WRT](https://github.com/x-wrt/x-wrt)默认集成了fakemesh功能\n\n## fakemesh 使用\n\n### 组网成功后统一的访问设备的地址格式如下:\n\n访问控制器的地址: `http://controller.fakemesh/`或者`http://ac.fakemesh/`\n\n访问AP的地址: `http://{mac}.ap.fakemesh/` 或者 `http://N.ap.fakemesh/`\n\n其中`{mac}`是AP的MAC地址，比如`{mac}=1122334455AB`，`N`是AP的自动编号，比如 N=1, N=2, N=3, ...\n\n例子:\n```\nhttp://1.ap.fakemesh/\nhttp://1122334455AB.ap.fakemesh/\n```\n\n### 故障处理:\n\nAP离线3分钟左右进入故障模式，这个模式开启默认SSID，可以提供接入管理重新配置。\n故障模式的默认SSID和密码是:\n```\nSSID: X-WRT_XXXX\nPASSWD: 88888888\n```\n\n故障模式下AP的管理IP地址是DHCP的网关地址，比如电脑获取到`192.168.16.x`的IP，那么AP的管理IP就是`192.168.16.1`\n\n## fakemesh 基本组成\n\n组网由一个`控制器(controller)`和一个或者多个`AP`组成\n\nAP包括: `卫星(Agent)`和`有线AP(Wired AP)`两种\n\n**控制器(Controller)**:  作为AC和出口路由器，提供网络出口上网，统一管理下挂的卫星和有线AP，统一管理无线\n\n**卫星(Agent)**:  通过Wi-Fi组网接入的AP\n\n**有线AP(Wired AP)**:  通过网线组网接入的AP\n\n## fakemesh 配置参数\n\n### 1. Mesh ID\n\n   这个参数是fakemesh网络组网的统一ID，控制器、卫星、有线AP都要设置相同的Mesh ID。\n\n### 2. 密钥(Key)\n\n   这是组网的统一密钥，组网加密需要，如果不需要加密可以留空白。\n\n### 3. 带宽(Band)\n\n   这是组网使用的无线频段，要设置相同，5G或者2G。\n\n### 4. 角色(Role)\n\n   可以是控制器、卫星、有线AP。\n\n### 5. 同步配置(Sync Config)\n\n   是否统一管理Wi-Fi配置等，Wi-Fi配置由控制器统一配置管理。\n\n### 6. 访问 IP 地址(Access IP address)\n\n   设置一个特定的IP地址给控制器，可以通过这个IP访问控制器的管理界面。\n\n### 7. 关闭前传(Fronthaul Disabled)\n   这个节点关闭前传无线信号，也就是不允许其他AP节点通过这个节点Wi-Fi接入。\n\n### 8. 漫游组件(Band Steer Helper)\n   目前可以选择[DAWN](https://github.com/fakemesh/dawn)或者[usteer](https://github.com/fakemesh/usteer)作为漫游辅助控件。\n\n## 无线管理(Wireless Management)\n\n   可以在控制器界面上统一管理无线，包括增删SSID，设置SSID的加密方式，频宽。\n\n## 控制器(Controller)旁路部署\n\n   需要注意的是，如果控制器不作为网关出口并且不提供DHCP服务，用户需要手动配置网络设置，包括设置控制器的LAN口IP地址、网关IP和DNS。此外，通常控制器的LAN口会默认启用DHCP客户端，从第三方网关获取IP和网关，如果需要使用静态IP，则需要保证控制器和第三方网关在同一个网段且可以相互通信。否则，就无法实现控制器与其他AP的同步配置。","filePath":"src/content/posts/x-wrt luci-app-fakemesh.md","digest":"d489eefbad24ad02","rendered":{"html":"<p>文章来源：<a href=\"https://github.com/x-wrt/com.x-wrt/tree/master/luci-app-fakemesh\" rel=\"nofollow\" target=\"_blank\">https://github.com/x-wrt/com.x-wrt/tree/master/luci-app-fakemesh</a></p>\n<section><h2 id=\"fakemesh简介\">fakemesh简介<a class=\"anchor\" href=\"#fakemesh简介\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>fakemesh是一种网络拓扑结构，由一个<code>控制器（AC）</code>和一个或多个<code>有线AP（Wired AP）</code>和<code>卫星（Agent）</code>组成。它是一种混合了<code>无线Mesh</code>和<code>AC+AP</code>两种组网模式的混合网络，其中，<code>有线AP</code>通过网线和<code>控制器（AC）</code>相连，而<code>卫星（Agent）</code>则通过无线STA方式接入，共同构成一个无线（包括有线）覆盖网络。</p><p>fakemesh的部署确实相对较为方便，只需要将节点设备连接到正确的网络，并设置节点设备的角色，Mesh ID等信息即可。因为fakemesh结合了无线Mesh和AC+AP两种组网模式，所以也可以很方便地进行混合组网，提高了网络的覆盖范围和可靠性。</p><p>目前<a href=\"https://github.com/x-wrt/x-wrt\" rel=\"nofollow\" target=\"_blank\">X-WRT</a>默认集成了fakemesh功能</p></section>\n<section><h2 id=\"fakemesh-使用\">fakemesh 使用<a class=\"anchor\" href=\"#fakemesh-使用\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"组网成功后统一的访问设备的地址格式如下\">组网成功后统一的访问设备的地址格式如下:<a class=\"anchor\" href=\"#组网成功后统一的访问设备的地址格式如下\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>访问控制器的地址: <code>http://controller.fakemesh/</code>或者<code>http://ac.fakemesh/</code></p><p>访问AP的地址: <code>http://{mac}.ap.fakemesh/</code> 或者 <code>http://N.ap.fakemesh/</code></p><p>其中<code>{mac}</code>是AP的MAC地址，比如<code>{mac}=1122334455AB</code>，<code>N</code>是AP的自动编号，比如 N=1, N=2, N=3, …</p><p>例子:</p><div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.4l8yc.css\"><script type=\"module\" src=\"/_astro/ec.g1fg5.js\">\x3C/script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:32ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">http://1.ap.fakemesh/</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">http://1122334455AB.ap.fakemesh/</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section><section><h3 id=\"故障处理\">故障处理:<a class=\"anchor\" href=\"#故障处理\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>AP离线3分钟左右进入故障模式，这个模式开启默认SSID，可以提供接入管理重新配置。\n故障模式的默认SSID和密码是:</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:16ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">SSID: X-WRT_XXXX</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">PASSWD: 88888888</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>故障模式下AP的管理IP地址是DHCP的网关地址，比如电脑获取到<code>192.168.16.x</code>的IP，那么AP的管理IP就是<code>192.168.16.1</code></p></section></section>\n<section><h2 id=\"fakemesh-基本组成\">fakemesh 基本组成<a class=\"anchor\" href=\"#fakemesh-基本组成\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>组网由一个<code>控制器(controller)</code>和一个或者多个<code>AP</code>组成</p><p>AP包括: <code>卫星(Agent)</code>和<code>有线AP(Wired AP)</code>两种</p><p><strong>控制器(Controller)</strong>:  作为AC和出口路由器，提供网络出口上网，统一管理下挂的卫星和有线AP，统一管理无线</p><p><strong>卫星(Agent)</strong>:  通过Wi-Fi组网接入的AP</p><p><strong>有线AP(Wired AP)</strong>:  通过网线组网接入的AP</p></section>\n<section><h2 id=\"fakemesh-配置参数\">fakemesh 配置参数<a class=\"anchor\" href=\"#fakemesh-配置参数\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><section><h3 id=\"1-mesh-id\">1. Mesh ID<a class=\"anchor\" href=\"#1-mesh-id\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>这个参数是fakemesh网络组网的统一ID，控制器、卫星、有线AP都要设置相同的Mesh ID。</p></section><section><h3 id=\"2-密钥key\">2. 密钥(Key)<a class=\"anchor\" href=\"#2-密钥key\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>这是组网的统一密钥，组网加密需要，如果不需要加密可以留空白。</p></section><section><h3 id=\"3-带宽band\">3. 带宽(Band)<a class=\"anchor\" href=\"#3-带宽band\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>这是组网使用的无线频段，要设置相同，5G或者2G。</p></section><section><h3 id=\"4-角色role\">4. 角色(Role)<a class=\"anchor\" href=\"#4-角色role\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>可以是控制器、卫星、有线AP。</p></section><section><h3 id=\"5-同步配置sync-config\">5. 同步配置(Sync Config)<a class=\"anchor\" href=\"#5-同步配置sync-config\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>是否统一管理Wi-Fi配置等，Wi-Fi配置由控制器统一配置管理。</p></section><section><h3 id=\"6-访问-ip-地址access-ip-address\">6. 访问 IP 地址(Access IP address)<a class=\"anchor\" href=\"#6-访问-ip-地址access-ip-address\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>设置一个特定的IP地址给控制器，可以通过这个IP访问控制器的管理界面。</p></section><section><h3 id=\"7-关闭前传fronthaul-disabled\">7. 关闭前传(Fronthaul Disabled)<a class=\"anchor\" href=\"#7-关闭前传fronthaul-disabled\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>这个节点关闭前传无线信号，也就是不允许其他AP节点通过这个节点Wi-Fi接入。</p></section><section><h3 id=\"8-漫游组件band-steer-helper\">8. 漫游组件(Band Steer Helper)<a class=\"anchor\" href=\"#8-漫游组件band-steer-helper\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>目前可以选择<a href=\"https://github.com/fakemesh/dawn\" rel=\"nofollow\" target=\"_blank\">DAWN</a>或者<a href=\"https://github.com/fakemesh/usteer\" rel=\"nofollow\" target=\"_blank\">usteer</a>作为漫游辅助控件。</p></section></section>\n<section><h2 id=\"无线管理wireless-management\">无线管理(Wireless Management)<a class=\"anchor\" href=\"#无线管理wireless-management\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>可以在控制器界面上统一管理无线，包括增删SSID，设置SSID的加密方式，频宽。</p></section>\n<section><h2 id=\"控制器controller旁路部署\">控制器(Controller)旁路部署<a class=\"anchor\" href=\"#控制器controller旁路部署\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>需要注意的是，如果控制器不作为网关出口并且不提供DHCP服务，用户需要手动配置网络设置，包括设置控制器的LAN口IP地址、网关IP和DNS。此外，通常控制器的LAN口会默认启用DHCP客户端，从第三方网关获取IP和网关，如果需要使用静态IP，则需要保证控制器和第三方网关在同一个网段且可以相互通信。否则，就无法实现控制器与其他AP的同步配置。</p></section>","metadata":{"headings":[{"depth":2,"slug":"fakemesh简介","text":"fakemesh简介#"},{"depth":2,"slug":"fakemesh-使用","text":"fakemesh 使用#"},{"depth":3,"slug":"组网成功后统一的访问设备的地址格式如下","text":"组网成功后统一的访问设备的地址格式如下:#"},{"depth":3,"slug":"故障处理","text":"故障处理:#"},{"depth":2,"slug":"fakemesh-基本组成","text":"fakemesh 基本组成#"},{"depth":2,"slug":"fakemesh-配置参数","text":"fakemesh 配置参数#"},{"depth":3,"slug":"1-mesh-id","text":"1. Mesh ID#"},{"depth":3,"slug":"2-密钥key","text":"2. 密钥(Key)#"},{"depth":3,"slug":"3-带宽band","text":"3. 带宽(Band)#"},{"depth":3,"slug":"4-角色role","text":"4. 角色(Role)#"},{"depth":3,"slug":"5-同步配置sync-config","text":"5. 同步配置(Sync Config)#"},{"depth":3,"slug":"6-访问-ip-地址access-ip-address","text":"6. 访问 IP 地址(Access IP address)#"},{"depth":3,"slug":"7-关闭前传fronthaul-disabled","text":"7. 关闭前传(Fronthaul Disabled)#"},{"depth":3,"slug":"8-漫游组件band-steer-helper","text":"8. 漫游组件(Band Steer Helper)#"},{"depth":2,"slug":"无线管理wireless-management","text":"无线管理(Wireless Management)#"},{"depth":2,"slug":"控制器controller旁路部署","text":"控制器(Controller)旁路部署#"}],"localImagePaths":[],"remoteImagePaths":[],"frontmatter":{"title":"X-wrt luci-app-fakemesh","published":"2024-08-09T00:00:00.000Z","description":"X-wrt luci-app-fakemesh介绍及使用教程","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","mesh","luci-app-fakemesh","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":5,"words":906,"excerpt":"文章来源：https://github.com/x-wrt/com.x-wrt/tree/master/luci-app-fakemesh"},"imagePaths":[]}},"collection":"posts","slug":"x-wrt-luci-app-fakemesh"};
const umamiConfig = {"enable":false,"baseUrl":"","shareId":"","timezone":"Asia/Shanghai"};

    // 获取文章浏览量统计
    async function fetchPostCardViews(slug) {
        if (!umamiConfig.enable) {
            return;
        }
        
        try {
            // 调用全局工具获取 Umami 分享数据
            const { websiteId, token } = await getUmamiShareData(umamiConfig.baseUrl, umamiConfig.shareId);
            
            // 第二步：获取统计数据
            const currentTimestamp = Date.now();
            const statsUrl = `${umamiConfig.baseUrl}/api/websites/${websiteId}/stats?startAt=0&endAt=${currentTimestamp}&unit=hour&timezone=${encodeURIComponent(umamiConfig.timezone)}&path=eq.%2Fposts%2F${slug}%2F&compare=false`;
            
            const statsResponse = await fetch(statsUrl, {
                headers: {
                    'x-umami-share-token': token
                }
            });
            
            if (statsResponse.status === 401) {
                clearUmamiShareCache();
                return await fetchPostCardViews(slug);
            }
            
            if (!statsResponse.ok) {
                throw new Error('获取统计数据失败');
            }
            
            const statsData = await statsResponse.json();
            const pageViews = statsData.pageviews || 0;
            const visits = statsData.visitors || 0;
            
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
             if (viewsElement) {
                 viewsElement.textContent = pageViews;
             }
             if (visitorsElement) {
                 visitorsElement.textContent = visits;
             }
        } catch (error) {
            console.error('Error fetching page views for', slug, ':', error);
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
            if (viewsElement) {
                viewsElement.textContent = '-';
            }
            if (visitorsElement) {
                visitorsElement.textContent = '-';
            }
        }
    }

    // 页面加载完成后获取统计数据
    function initPostCardStats() {
        const slug = entry.slug;
        if (slug) {
            fetchPostCardViews(slug);
        }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initPostCardStats);
    } else {
        initPostCardStats();
    }
})();</script> <div class="card-base flex flex-col-reverse md:flex-col w-full rounded-[var(--radius-large)] overflow-hidden relative onload-animation" style="animation-delay: calc(var(--content-delay) + 150ms);; --coverWidth: 28%;" data-astro-cid-iyiqi2so> <div class="pl-6 md:pl-9 pr-6 md:pr-2 pt-6 md:pt-7 pb-6 relative w-full md:w-[calc(100%_-_var(--coverWidth)_-_12px)]" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <a href="/posts/x-wrt-install-on-vps2/" class="transition group w-full block font-bold mb-3 text-3xl text-90
        hover:text-[var(--primary)] dark:hover:text-[var(--primary)]
        active:text-[var(--title-active)] dark:active:text-[var(--title-active)]
        before:w-1 before:h-5 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:top-[35px] before:left-[18px] before:hidden md:before:block
        " data-astro-cid-iyiqi2so style="--coverWidth: 28%;">  X-wrt install on vps <svg width="1em" height="1em" viewBox="0 0 24 24" class="inline text-[2rem] text-[var(--primary)] md:hidden translate-y-0.5 absolute" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-[var(--primary)] text-[2rem] transition hidden md:inline absolute translate-y-0.5 opacity-0 group-hover:opacity-100 -translate-x-1 group-hover:translate-x-0" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </a> <!-- metadata --> <div class="flex flex-wrap text-neutral-500 dark:text-neutral-400 items-center gap-4 gap-x-4 gap-y-2 mb-4"> <!-- publish date --> <div class="flex items-center"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:calendar-today-outline-rounded">   <use href="#ai:material-symbols:calendar-today-outline-rounded"></use>  </svg> </div> <span class="text-50 text-sm font-medium">2024-08-09</span> </div> <!-- update date -->  <!-- tags --> <div class="items-center hidden md:flex"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:tag-rounded">   <use href="#ai:material-symbols:tag-rounded"></use>  </svg> </div> <div class="flex flex-row flex-nowrap items-center"> <div class="hidden mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/x-wrt/" aria-label="View all posts with the x-wrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> x-wrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/X-WRT/" aria-label="View all posts with the X-WRT tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> X-WRT </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/openwrt/" aria-label="View all posts with the openwrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> openwrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/VPS/" aria-label="View all posts with the VPS tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> VPS </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/vps/" aria-label="View all posts with the vps tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> vps </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/教程/" aria-label="View all posts with the 教程 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 教程 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/技术分享/" aria-label="View all posts with the 技术分享 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 技术分享 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/网络/" aria-label="View all posts with the 网络 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 网络 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/路由器/" aria-label="View all posts with the 路由器 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 路由器 </a>  </div> </div> <!-- page views & visitors -->  </div>  <!-- description --> <div class="transition text-75 mb-3.5 pr-4" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> 将X-wrt安装到VPS上 </div> <!-- word count, read time and page views --> <div class="text-sm text-black/30 dark:text-white/30 flex gap-4 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">1417 字</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">7 分钟</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div class="flex items-center gap-2" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:visibility-outline">   <use href="#ai:material-symbols:visibility-outline"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-views-x-wrt-install-on-vps2" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:person">   <use href="#ai:material-symbols:person"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-visitors-x-wrt-install-on-vps2" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> </div> </div> </div> <a href="/posts/x-wrt-install-on-vps2/" aria-label="X-wrt install on vps" class="group max-h-[20vh] md:max-h-none mx-4 mt-4 -mb-2 md:mb-0 md:mx-0 md:mt-0 md:w-[var(--coverWidth)] relative md:absolute md:top-3 md:bottom-3 md:right-3 rounded-xl overflow-hidden active:scale-95" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="absolute pointer-events-none z-10 w-full h-full group-hover:bg-black/30 group-active:bg-black/50 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <!-- 封面图上的箭头 --> <div class="absolute pointer-events-none z-20 w-full h-full flex items-center justify-center " data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition opacity-0 group-hover:opacity-100 scale-50 group-hover:scale-100 text-white text-5xl" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </div> <div class="w-full h-full overflow-hidden relative image-wrapper" style="--theme-hue: 215" data-astro-cid-i2xmscho> <!-- 加载条 --> <div class="loading-bar absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-1 bg-gray-200 dark:bg-gray-700 z-10 rounded-full overflow-hidden" data-astro-cid-i2xmscho> <div class="loading-progress h-full w-8 bg-[oklch(0.70_0.14_var(--theme-hue))] animate-loading-progress rounded-full" data-astro-cid-i2xmscho></div> </div> <!-- 图片内容 --> <img src="/_astro/x-wrt-logo-min.CVnPatDP_19DKCs.svg" alt="Cover Image of the Post" style="object-position: center" onload="this.style.opacity='1'; this.parentElement.querySelector('.loading-bar').style.opacity='0';" data-astro-cid-i2xmscho="true" width="147" height="147" loading="lazy" decoding="async" class="w-full h-full object-cover image-content opacity-0 transition-opacity duration-500">  </div>  </a>  </div> <div class="transition border-t-[1px] border-dashed mx-6 border-black/10 dark:border-white/[0.15] last:border-t-0 md:hidden" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <script>(function(){const entry = {"id":"x-wrt-install-on-vps2.md","data":{"title":"X-wrt install on vps","published":"2024-08-09T00:00:00.000Z","description":"将X-wrt安装到VPS上","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","VPS","vps","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":7,"words":1417,"excerpt":"文章来源：https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/install-on-vps2","nextSlug":"x-wrt-luci-app-fakemesh","nextTitle":"X-wrt luci-app-fakemesh","prevSlug":"how-to-build-x-wrt","prevTitle":"如何编译X-WRT"},"body":"文章来源：https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/install-on-vps2\n\n# X-WRT 安装部署到VPS上(新)\n\n### 1. 介绍:\n\n本教程旨在介绍如何将 X-WRT 系统部署到云服务器（VPS）上。X-WRT 是一个专为路由器设计的开源系统，具有出色的网络转发优化和友好的配置界面。同时，该系统还提供了许多方便的服务，如 OpenVPN 等，可以轻松地一键部署。\n\n需要注意的是，本教程适用于大多数 VPS，如 vultr、digitalocean、Amazon 的 AWS、Linode、阿里云、腾讯云等。然而，由于不同云服务商的实际情况不同，您需要灵活应对，根据实际情况做出正确的处理。\n\n本教程只适用于 X-WRT 固件，可以保证几乎 100% 成功地将 X-WRT 系统部署到所有的 VPS 上。\n\n### 2. 教程:\n\n#### 2.1 固件下载\n我们选择 x86 64 位 (MBR dos) 或 x86 64 位 (UEFI gpt) 的固件进行部署。您可以从以下链接下载所需的文件：\n\n[https://downloads.x-wrt.com/rom/](https://downloads.x-wrt.com/rom/)\n\n刷机所需的文件如下：\n```\nx-wrt-x86-64-generic-initramfs-kernel.bin\nx-wrt-x86-64-generic-ext4-combined.img.gz\n```\n\n如果您的系统是 EFI 系统，则还需要下载以下文件：\n```\nx-wrt-x86-64-generic-ext4-combined-efi.img.gz\n```\n\n#### 2.2 VPS系统部署\n本教程所涉及的 VPS 系统要求比较宽松，可以是 Ubuntu、CentOS、Debian 或其他类 Unix 系统。\n\n#### 2.3 VPS系统的网络配置识别\n在开始部署之前，我们需要了解 VPS 的 IP 地址是如何分配的。有些 VPS 是通过 DHCP 自动获取 IP 地址，有些是静态配置的，还有一些是双网卡或多网卡的。\n\n登录 VPS 后，可以使用 `ifconfig` 或者 `ip addr list` 命令查看 VPS 的网卡 IP 地址。然后，使用命令 `grep /etc -nre <IP>` 查找包含此 `<IP>` 的文件。如果找到了相关文件，并且文件内容包含静态配置的脚本，那么我们可以确定该 VPS 是静态配置的。否则，它是动态配置的。\n\n此外，我们还需要观察 VPS 是否具有多个网口。如果是，那么在安装过程中需要特别注意。下面将有进一步的说明。\n\n#### 2.4 确定磁盘的路径和分区类型\n使用 `df` 和 `mount` 命令可以查看 VPS 的磁盘信息，确定磁盘的第一个分区挂载路径，例如 `/dev/sda1`、`/dev/vda1`、`/dev/xvda1` 等等。需要注意的是，此分区的挂载路径以及可用空间大小，通常情况下此分区挂载在 `/` 或者 `/boot` 下，而我们在刷机过程中需要将固件等文件保存在此路径下。\n\n使用 `fdisk -l` 命令可以查看分区类型，以确定分区是否为 GPT。如果分区为 GPT，则需要刷写 EFI 固件。但通常情况下分区不是 GPT 类型。\n\n#### 2.5 开始刷机\n以下是刷机所需的文件，您可以使用 wget 命令进行下载：\n```\nx-wrt-x86-64-generic-initramfs-kernel.bin\nx-wrt-x86-64-generic-ext4-combined.img.gz 或者 x-wrt-x86-64-generic-ext4-combined-efi.img.gz\n```\n\n在刷机之前，需要确定当前系统运行的内核路径。一般来说，这个路径是 `/boot/vmlinuz*`。您可以使用 `uname -r` 命令查看内核版本。比如，如果路径是 `/boot/vmlinuz-4.15.0-111-generic`，那么我们需要把 `x-wrt-x86-64-generic-initramfs-kernel.bin` 替换为这个内核：\n```\ncp x-wrt-x86-64-generic-initramfs-kernel.bin /boot/vmlinuz-4.15.0-111-generic\n```\n\n然后我们需要确定第一个分区的路径，假如第一个分区是 `/` 我们把固件拷贝到 `/` 保存好，注意保存的名字是 `x-wrt.img.gz`\n```\ncp x-wrt-x86-64-generic-ext4-combined.img.gz /x-wrt.img.gz\n```\n\n同时我们还需要一个安装脚本，脚本路径和固件保存的目录相同，这个例子是`/` ，脚本名字是 `x-wrt-install-vps.sh` 脚本的代码参考如下：（根据情况修改）\n```\n#!/bin/sh\n\n# install to sda\nBDEV=sda\n\n# x-wrt.img.gz in disk part sda1\nDDEV=sda1\n\n# static ip\n#network=172.21.170.245,255.255.240.0,172.21.175.253,8.8.8.8\n\n# static ip swap eth0 eth1\n#network=\"117.18.13.159,255.255.255.0,117.18.13.1,8.8.8.8,initscript=dWNpIHNldCBuZXR3b3JrLmxhbi5pZm5hbWU9ZXRoMQp1Y2kgc2V0IG5ldHdvcmsud2FuLmlmbmFtZT1ldGgwCnVjaSBjb21taXQgbmV0d29yawo=\"\n\n# dhcp ip\nnetwork=dhcp\n\nvmroot=/tmp/block\nmkdir -p $vmroot\nmount /dev/${DDEV} $vmroot || exit 0\ncp $vmroot/x-wrt.img.gz /tmp/x-wrt.img.gz && {\n\tcd /\n\tumount $vmroot\n\tsync\n\t(zcat /tmp/x-wrt.img.gz;\n\t echo open=443,network=$network;\n\t) >/dev/$BDEV && reboot\n}\n```\n\n这个脚本准备刷机的磁盘是sda，第一个分区是sda1，它是DHCP动态获取IP的。你需要根据情况修改刷机脚本，脚本会在重启后启动initramfs内核并且执行。\n\n如果磁盘是vda，就修改BDEV的值，注意，如果是静态IP，就注释掉`network=dhcp`，启用静态IP那一行的`network=<ip>,<mask>,<gateway>,<dns>`，如果VPS有多个网卡，比如有2个`eth0 eth1`，我们需要附加一个`initscript=<script base64 codes>`来做交换网口，这个`<script base64 codes>`其实是如下脚本的base64编码，你要根据情况修改。\n```\nuci set network.lan.ifname=eth1\nuci set network.wan.ifname=eth0\nuci commit network\n```\n\n如果以上操作正确无误，就执行`reboot`重启系统。由于我们使用initramfs-kernel替换了原有内核，重启后系统会进入initramfs-kernel环境。然后，该环境会查找 x-wrt-install-vps.sh 脚本并执行刷机操作。这个脚本执行的内容很简单：挂载第一个分区、将固件拷贝到 /tmp 目录中，然后执行刷机并重启。这个过程大概需要5分钟，看情况了。\n\n### 3. 总结:\n\n整个刷机过程，大概就三个步骤:\n1. 下载好两个固件文件，保存到特定的路径\n2. 拷贝并且根据情况修改好一个脚本(`x-wrt-install-vps.sh`)，保存到特定路径\n3. 重启(reboot)并等待自动安装完成\n\n系统重启后，你将能够通过访问 X-WRT 的管理界面来配置路由器。以本文的例子为例，管理界面的地址(HTTPS)是 `https://[VPS_IP]/`。进入管理界面后，你需要立即修改默认的管理密码。默认的账号/密码是 admin/admin。此外，如果需要，你可以进入系统管理页面，启用 SSH 账户密码登录，并设置防火墙以允许来自 WAN 区域的22端口访问。这样可以使你能够远程登录到路由器并进行更多的配置。","filePath":"src/content/posts/x-wrt-install-on-vps2.md","digest":"36820b9c32bf440e","rendered":{"html":"<p>文章来源：<a href=\"https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/install-on-vps2\" rel=\"nofollow\" target=\"_blank\">https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/install-on-vps2</a></p>\n<section><h1 id=\"x-wrt-安装部署到vps上新\">X-WRT 安装部署到VPS上(新)<a class=\"anchor\" href=\"#x-wrt-安装部署到vps上新\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h1><section><h3 id=\"1-介绍\">1. 介绍:<a class=\"anchor\" href=\"#1-介绍\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>本教程旨在介绍如何将 X-WRT 系统部署到云服务器（VPS）上。X-WRT 是一个专为路由器设计的开源系统，具有出色的网络转发优化和友好的配置界面。同时，该系统还提供了许多方便的服务，如 OpenVPN 等，可以轻松地一键部署。</p><p>需要注意的是，本教程适用于大多数 VPS，如 vultr、digitalocean、Amazon 的 AWS、Linode、阿里云、腾讯云等。然而，由于不同云服务商的实际情况不同，您需要灵活应对，根据实际情况做出正确的处理。</p><p>本教程只适用于 X-WRT 固件，可以保证几乎 100% 成功地将 X-WRT 系统部署到所有的 VPS 上。</p></section><section><h3 id=\"2-教程\">2. 教程:<a class=\"anchor\" href=\"#2-教程\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><section><h4 id=\"21-固件下载\">2.1 固件下载<a class=\"anchor\" href=\"#21-固件下载\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><p>我们选择 x86 64 位 (MBR dos) 或 x86 64 位 (UEFI gpt) 的固件进行部署。您可以从以下链接下载所需的文件：</p><p><a href=\"https://downloads.x-wrt.com/rom/\" rel=\"nofollow\" target=\"_blank\">https://downloads.x-wrt.com/rom/</a></p><p>刷机所需的文件如下：</p><div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.4l8yc.css\"><script type=\"module\" src=\"/_astro/ec.g1fg5.js\">\x3C/script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:41ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">x-wrt-x86-64-generic-initramfs-kernel.bin</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">x-wrt-x86-64-generic-ext4-combined.img.gz</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>如果您的系统是 EFI 系统，则还需要下载以下文件：</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:45ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">x-wrt-x86-64-generic-ext4-combined-efi.img.gz</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section><section><h4 id=\"22-vps系统部署\">2.2 VPS系统部署<a class=\"anchor\" href=\"#22-vps系统部署\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><p>本教程所涉及的 VPS 系统要求比较宽松，可以是 Ubuntu、CentOS、Debian 或其他类 Unix 系统。</p></section><section><h4 id=\"23-vps系统的网络配置识别\">2.3 VPS系统的网络配置识别<a class=\"anchor\" href=\"#23-vps系统的网络配置识别\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><p>在开始部署之前，我们需要了解 VPS 的 IP 地址是如何分配的。有些 VPS 是通过 DHCP 自动获取 IP 地址，有些是静态配置的，还有一些是双网卡或多网卡的。</p><p>登录 VPS 后，可以使用 <code>ifconfig</code> 或者 <code>ip addr list</code> 命令查看 VPS 的网卡 IP 地址。然后，使用命令 <code>grep /etc -nre &#x3C;IP></code> 查找包含此 <code>&#x3C;IP></code> 的文件。如果找到了相关文件，并且文件内容包含静态配置的脚本，那么我们可以确定该 VPS 是静态配置的。否则，它是动态配置的。</p><p>此外，我们还需要观察 VPS 是否具有多个网口。如果是，那么在安装过程中需要特别注意。下面将有进一步的说明。</p></section><section><h4 id=\"24-确定磁盘的路径和分区类型\">2.4 确定磁盘的路径和分区类型<a class=\"anchor\" href=\"#24-确定磁盘的路径和分区类型\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><p>使用 <code>df</code> 和 <code>mount</code> 命令可以查看 VPS 的磁盘信息，确定磁盘的第一个分区挂载路径，例如 <code>/dev/sda1</code>、<code>/dev/vda1</code>、<code>/dev/xvda1</code> 等等。需要注意的是，此分区的挂载路径以及可用空间大小，通常情况下此分区挂载在 <code>/</code> 或者 <code>/boot</code> 下，而我们在刷机过程中需要将固件等文件保存在此路径下。</p><p>使用 <code>fdisk -l</code> 命令可以查看分区类型，以确定分区是否为 GPT。如果分区为 GPT，则需要刷写 EFI 固件。但通常情况下分区不是 GPT 类型。</p></section><section><h4 id=\"25-开始刷机\">2.5 开始刷机<a class=\"anchor\" href=\"#25-开始刷机\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h4><p>以下是刷机所需的文件，您可以使用 wget 命令进行下载：</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:90ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">x-wrt-x86-64-generic-initramfs-kernel.bin</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">x-wrt-x86-64-generic-ext4-combined.img.gz 或者 x-wrt-x86-64-generic-ext4-combined-efi.img.gz</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>在刷机之前，需要确定当前系统运行的内核路径。一般来说，这个路径是 <code>/boot/vmlinuz*</code>。您可以使用 <code>uname -r</code> 命令查看内核版本。比如，如果路径是 <code>/boot/vmlinuz-4.15.0-111-generic</code>，那么我们需要把 <code>x-wrt-x86-64-generic-initramfs-kernel.bin</code> 替换为这个内核：</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:77ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">cp x-wrt-x86-64-generic-initramfs-kernel.bin /boot/vmlinuz-4.15.0-111-generic</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>然后我们需要确定第一个分区的路径，假如第一个分区是 <code>/</code> 我们把固件拷贝到 <code>/</code> 保存好，注意保存的名字是 <code>x-wrt.img.gz</code></p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:58ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">cp x-wrt-x86-64-generic-ext4-combined.img.gz /x-wrt.img.gz</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>同时我们还需要一个安装脚本，脚本路径和固件保存的目录相同，这个例子是<code>/</code> ，脚本名字是 <code>x-wrt-install-vps.sh</code> 脚本的代码参考如下：（根据情况修改）</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:182ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">#!/bin/sh</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\"># install to sda</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">BDEV=sda</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\"># x-wrt.img.gz in disk part sda1</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">DDEV=sda1</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\"># static ip</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">#network=172.21.170.245,255.255.240.0,172.21.175.253,8.8.8.8</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\"># static ip swap eth0 eth1</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">#network=\"117.18.13.159,255.255.255.0,117.18.13.1,8.8.8.8,initscript=dWNpIHNldCBuZXR3b3JrLmxhbi5pZm5hbWU9ZXRoMQp1Y2kgc2V0IG5ldHdvcmsud2FuLmlmbmFtZT1ldGgwCnVjaSBjb21taXQgbmV0d29yawo=\"</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\"># dhcp ip</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">network=dhcp</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">vmroot=/tmp/block</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">mkdir -p $vmroot</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">mount /dev/${DDEV} $vmroot || exit 0</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">cp $vmroot/x-wrt.img.gz /tmp/x-wrt.img.gz &#x26;&#x26; {</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">  </span></span><span style=\"--0:#e1e4e8;--1:#e1e4e8\">cd /</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">  </span></span><span style=\"--0:#e1e4e8;--1:#e1e4e8\">umount $vmroot</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">  </span></span><span style=\"--0:#e1e4e8;--1:#e1e4e8\">sync</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">  </span></span><span style=\"--0:#e1e4e8;--1:#e1e4e8\">(zcat /tmp/x-wrt.img.gz;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:3ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">   </span></span><span style=\"--0:#e1e4e8;--1:#e1e4e8\">echo open=443,network=$network;</span></div></div><div class=\"ec-line\" style=\"--ecIndent:2ch\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">27</div></div><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">  </span></span><span style=\"--0:#e1e4e8;--1:#e1e4e8\">) >/dev/$BDEV &#x26;&#x26; reboot</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">28</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">}</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>这个脚本准备刷机的磁盘是sda，第一个分区是sda1，它是DHCP动态获取IP的。你需要根据情况修改刷机脚本，脚本会在重启后启动initramfs内核并且执行。</p><p>如果磁盘是vda，就修改BDEV的值，注意，如果是静态IP，就注释掉<code>network=dhcp</code>，启用静态IP那一行的<code>network=&#x3C;ip>,&#x3C;mask>,&#x3C;gateway>,&#x3C;dns></code>，如果VPS有多个网卡，比如有2个<code>eth0 eth1</code>，我们需要附加一个<code>initscript=&#x3C;script base64 codes></code>来做交换网口，这个<code>&#x3C;script base64 codes></code>其实是如下脚本的base64编码，你要根据情况修改。</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:31ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">uci set network.lan.ifname=eth1</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">uci set network.wan.ifname=eth0</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">uci commit network</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>如果以上操作正确无误，就执行<code>reboot</code>重启系统。由于我们使用initramfs-kernel替换了原有内核，重启后系统会进入initramfs-kernel环境。然后，该环境会查找 x-wrt-install-vps.sh 脚本并执行刷机操作。这个脚本执行的内容很简单：挂载第一个分区、将固件拷贝到 /tmp 目录中，然后执行刷机并重启。这个过程大概需要5分钟，看情况了。</p></section></section><section><h3 id=\"3-总结\">3. 总结:<a class=\"anchor\" href=\"#3-总结\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>整个刷机过程，大概就三个步骤:</p><ol>\n<li>下载好两个固件文件，保存到特定的路径</li>\n<li>拷贝并且根据情况修改好一个脚本(<code>x-wrt-install-vps.sh</code>)，保存到特定路径</li>\n<li>重启(reboot)并等待自动安装完成</li>\n</ol><p>系统重启后，你将能够通过访问 X-WRT 的管理界面来配置路由器。以本文的例子为例，管理界面的地址(HTTPS)是 <code>https://[VPS_IP]/</code>。进入管理界面后，你需要立即修改默认的管理密码。默认的账号/密码是 admin/admin。此外，如果需要，你可以进入系统管理页面，启用 SSH 账户密码登录，并设置防火墙以允许来自 WAN 区域的22端口访问。这样可以使你能够远程登录到路由器并进行更多的配置。</p></section></section>","metadata":{"headings":[{"depth":1,"slug":"x-wrt-安装部署到vps上新","text":"X-WRT 安装部署到VPS上(新)#"},{"depth":3,"slug":"1-介绍","text":"1. 介绍:#"},{"depth":3,"slug":"2-教程","text":"2. 教程:#"},{"depth":4,"slug":"21-固件下载","text":"2.1 固件下载#"},{"depth":4,"slug":"22-vps系统部署","text":"2.2 VPS系统部署#"},{"depth":4,"slug":"23-vps系统的网络配置识别","text":"2.3 VPS系统的网络配置识别#"},{"depth":4,"slug":"24-确定磁盘的路径和分区类型","text":"2.4 确定磁盘的路径和分区类型#"},{"depth":4,"slug":"25-开始刷机","text":"2.5 开始刷机#"},{"depth":3,"slug":"3-总结","text":"3. 总结:#"}],"localImagePaths":[],"remoteImagePaths":[],"frontmatter":{"title":"X-wrt install on vps","published":"2024-08-09T00:00:00.000Z","description":"将X-wrt安装到VPS上","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","VPS","vps","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":7,"words":1417,"excerpt":"文章来源：https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/install-on-vps2"},"imagePaths":[]}},"collection":"posts","slug":"x-wrt-install-on-vps2"};
const umamiConfig = {"enable":false,"baseUrl":"","shareId":"","timezone":"Asia/Shanghai"};

    // 获取文章浏览量统计
    async function fetchPostCardViews(slug) {
        if (!umamiConfig.enable) {
            return;
        }
        
        try {
            // 调用全局工具获取 Umami 分享数据
            const { websiteId, token } = await getUmamiShareData(umamiConfig.baseUrl, umamiConfig.shareId);
            
            // 第二步：获取统计数据
            const currentTimestamp = Date.now();
            const statsUrl = `${umamiConfig.baseUrl}/api/websites/${websiteId}/stats?startAt=0&endAt=${currentTimestamp}&unit=hour&timezone=${encodeURIComponent(umamiConfig.timezone)}&path=eq.%2Fposts%2F${slug}%2F&compare=false`;
            
            const statsResponse = await fetch(statsUrl, {
                headers: {
                    'x-umami-share-token': token
                }
            });
            
            if (statsResponse.status === 401) {
                clearUmamiShareCache();
                return await fetchPostCardViews(slug);
            }
            
            if (!statsResponse.ok) {
                throw new Error('获取统计数据失败');
            }
            
            const statsData = await statsResponse.json();
            const pageViews = statsData.pageviews || 0;
            const visits = statsData.visitors || 0;
            
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
             if (viewsElement) {
                 viewsElement.textContent = pageViews;
             }
             if (visitorsElement) {
                 visitorsElement.textContent = visits;
             }
        } catch (error) {
            console.error('Error fetching page views for', slug, ':', error);
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
            if (viewsElement) {
                viewsElement.textContent = '-';
            }
            if (visitorsElement) {
                visitorsElement.textContent = '-';
            }
        }
    }

    // 页面加载完成后获取统计数据
    function initPostCardStats() {
        const slug = entry.slug;
        if (slug) {
            fetchPostCardViews(slug);
        }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initPostCardStats);
    } else {
        initPostCardStats();
    }
})();</script> <div class="card-base flex flex-col-reverse md:flex-col w-full rounded-[var(--radius-large)] overflow-hidden relative onload-animation" style="animation-delay: calc(var(--content-delay) + 200ms);; --coverWidth: 28%;" data-astro-cid-iyiqi2so> <div class="pl-6 md:pl-9 pr-6 md:pr-2 pt-6 md:pt-7 pb-6 relative w-full md:w-[calc(100%_-_var(--coverWidth)_-_12px)]" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <a href="/posts/how-to-build-x-wrt/" class="transition group w-full block font-bold mb-3 text-3xl text-90
        hover:text-[var(--primary)] dark:hover:text-[var(--primary)]
        active:text-[var(--title-active)] dark:active:text-[var(--title-active)]
        before:w-1 before:h-5 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:top-[35px] before:left-[18px] before:hidden md:before:block
        " data-astro-cid-iyiqi2so style="--coverWidth: 28%;">  如何编译X-WRT <svg width="1em" height="1em" viewBox="0 0 24 24" class="inline text-[2rem] text-[var(--primary)] md:hidden translate-y-0.5 absolute" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-[var(--primary)] text-[2rem] transition hidden md:inline absolute translate-y-0.5 opacity-0 group-hover:opacity-100 -translate-x-1 group-hover:translate-x-0" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </a> <!-- metadata --> <div class="flex flex-wrap text-neutral-500 dark:text-neutral-400 items-center gap-4 gap-x-4 gap-y-2 mb-4"> <!-- publish date --> <div class="flex items-center"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:calendar-today-outline-rounded">   <use href="#ai:material-symbols:calendar-today-outline-rounded"></use>  </svg> </div> <span class="text-50 text-sm font-medium">2024-08-09</span> </div> <!-- update date -->  <!-- tags --> <div class="items-center hidden md:flex"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:tag-rounded">   <use href="#ai:material-symbols:tag-rounded"></use>  </svg> </div> <div class="flex flex-row flex-nowrap items-center"> <div class="hidden mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/x-wrt/" aria-label="View all posts with the x-wrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> x-wrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/X-WRT/" aria-label="View all posts with the X-WRT tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> X-WRT </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/openwrt/" aria-label="View all posts with the openwrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> openwrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/编译/" aria-label="View all posts with the 编译 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 编译 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/教程/" aria-label="View all posts with the 教程 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 教程 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/技术分享、/" aria-label="View all posts with the 技术分享、 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 技术分享、 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/网络/" aria-label="View all posts with the 网络 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 网络 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/路由器/" aria-label="View all posts with the 路由器 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 路由器 </a>  </div> </div> <!-- page views & visitors -->  </div>  <!-- description --> <div class="transition text-75 mb-3.5 pr-4" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> X-WRT编译教程 </div> <!-- word count, read time and page views --> <div class="text-sm text-black/30 dark:text-white/30 flex gap-4 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">1228 字</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">6 分钟</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div class="flex items-center gap-2" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:visibility-outline">   <use href="#ai:material-symbols:visibility-outline"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-views-how-to-build-x-wrt" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:person">   <use href="#ai:material-symbols:person"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-visitors-how-to-build-x-wrt" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> </div> </div> </div> <a href="/posts/how-to-build-x-wrt/" aria-label="如何编译X-WRT" class="group max-h-[20vh] md:max-h-none mx-4 mt-4 -mb-2 md:mb-0 md:mx-0 md:mt-0 md:w-[var(--coverWidth)] relative md:absolute md:top-3 md:bottom-3 md:right-3 rounded-xl overflow-hidden active:scale-95" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="absolute pointer-events-none z-10 w-full h-full group-hover:bg-black/30 group-active:bg-black/50 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <!-- 封面图上的箭头 --> <div class="absolute pointer-events-none z-20 w-full h-full flex items-center justify-center " data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition opacity-0 group-hover:opacity-100 scale-50 group-hover:scale-100 text-white text-5xl" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </div> <div class="w-full h-full overflow-hidden relative image-wrapper" style="--theme-hue: 215" data-astro-cid-i2xmscho> <!-- 加载条 --> <div class="loading-bar absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-1 bg-gray-200 dark:bg-gray-700 z-10 rounded-full overflow-hidden" data-astro-cid-i2xmscho> <div class="loading-progress h-full w-8 bg-[oklch(0.70_0.14_var(--theme-hue))] animate-loading-progress rounded-full" data-astro-cid-i2xmscho></div> </div> <!-- 图片内容 --> <img src="/_astro/x-wrt-logo-min.CVnPatDP_19DKCs.svg" alt="Cover Image of the Post" style="object-position: center" onload="this.style.opacity='1'; this.parentElement.querySelector('.loading-bar').style.opacity='0';" data-astro-cid-i2xmscho="true" width="147" height="147" loading="lazy" decoding="async" class="w-full h-full object-cover image-content opacity-0 transition-opacity duration-500">  </div>  </a>  </div> <div class="transition border-t-[1px] border-dashed mx-6 border-black/10 dark:border-white/[0.15] last:border-t-0 md:hidden" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <script>(function(){const entry = {"id":"how-to-build-X-WRT.md","data":{"title":"如何编译X-WRT","published":"2024-08-09T00:00:00.000Z","description":"X-WRT编译教程","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","编译","教程","技术分享、","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":6,"words":1228,"excerpt":"文章来源：https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/build","nextSlug":"x-wrt-install-on-vps2","nextTitle":"X-wrt install on vps","prevSlug":"diy-openwrt","prevTitle":"自己动手编译 OpenWRT"},"body":"文章来源：https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/build\n# 编译教程\n\n很多人不知道怎样编译一个自己的固件，这里主要简单介绍大概的编译打包流程，具体的情况还需要大家自己发挥，情况千变万化，大家随机应变。\n\n## 1 编译准备\n我们建议使用[Ubuntu](https://www.ubuntu.com/)系统作为编译环境，这里以Ubuntu 22.04作为例子，其他版本也是可以的。特别注意的是，整个编译过程，都是用普通用户操作，不要用`root`用户操作。\n\n首先要安装编译所需要的软件包:\n`sudo apt install build-essential ecj fastjar file flex g++ gcc-multilib g++-multilib gawk gettext git git-core java-propose-classpath libelf-dev libncurses5-dev libncursesw5-dev libssl-dev swig python3 python3-dev python3-distutils python3-pyelftools subversion unzip wget zlib1g-dev rsync qemu-utils`\n\n下载源码:\n```sh\ngit clone https://github.com/x-wrt/x-wrt.git\ncd x-wrt\n\n#更新代码tag:\ngit fetch origin\ngit fetch origin --tags\n\n#列出可以使用的版本tag:\ngit tag\n#注意摁 q 键结束\n#或者直接获取最新发布版本\ngit describe --tags $(git rev-list --tags --max-count=1)\n\n#选择并切换到指定的版本tag:\ngit checkout -f <tag-name>\n#例如\ngit checkout -f 21.10_b202112032317\n#或者\ngit checkout -f $(git describe --tags $(git rev-list --tags --max-count=1))\n\n#更新代码:\n./scripts/feeds update -a\n./scripts/feeds install -a\n```\n\n配置固件的命令`make menuconfig` 但是我们可以从配置模版开始会更轻松一些。\n\n比如ramips-mt7621的设备可以用拷贝这个模版`feeds/x/rom/lede/config.ramips-mt7621`\n内核分区限制小的设备，选用 `-nosymbol` 结尾的`config`配置模版\n```sh\ncp feeds/x/rom/lede/config.ramips-mt7621 .config\n```\n\n由于这些模版是用来编译大量设备的，copy过来后，可以直接编译，不做任何改变。\n但是如果需要改变，需要`make menuconfig`自定义，就要做下面的操作:\n```sh\n# 上面已经cp 拷贝了模版配置到 .config\n# 例如 cp feeds/x/rom/lede/config.ramips-mt7621 .config\n# 下面继续操作和修改\n\n#1 执行\nmake menuconfig\n\n#2 进入 Target Profile 选择需要编译打包的设备型号，选择型号后立刻退出，保存\n```\n\n![](https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/build/build-target.png)\n\n```sh\n#3 执行下面的命令修复 .config\nsh feeds/x/rom/lede/fix-config.sh\n\n#4 再次执行 make menuconfig 然后立刻退出保存\n\n#5 最后一次 执行 make menuconfig 自定义选择你需要的软件包\n\n```\n\n还有更多配置模版，请参考目录下的`config.*`文件:\n```\nfeeds/x/rom/lede/config.ath79-generic\nfeeds/x/rom/lede/config.ath79-generic-nosymbol\nfeeds/x/rom/lede/config.ath79-nand\nfeeds/x/rom/lede/config.bcm27xx-bcm2709\nfeeds/x/rom/lede/config.bcm27xx-bcm2710\nfeeds/x/rom/lede/config.bcm27xx-bcm2711\nfeeds/x/rom/lede/config.bcm4908-generic\nfeeds/x/rom/lede/config.bcm53xx-generic\nfeeds/x/rom/lede/config.ipq40xx-generic\nfeeds/x/rom/lede/config.ipq806x-generic\nfeeds/x/rom/lede/config.kirkwood-generic\nfeeds/x/rom/lede/config.mediatek-mt7622\nfeeds/x/rom/lede/config.mvebu-cortexa53\nfeeds/x/rom/lede/config.mvebu-cortexa9\nfeeds/x/rom/lede/config.ramips-mt7620\nfeeds/x/rom/lede/config.ramips-mt7620-nosymbol\nfeeds/x/rom/lede/config.ramips-mt7621\nfeeds/x/rom/lede/config.ramips-mt76x8\nfeeds/x/rom/lede/config.ramips-mt76x8-nosymbol\nfeeds/x/rom/lede/config.ramips-rt305x\nfeeds/x/rom/lede/config.ramips-rt3883-nosymbol\nfeeds/x/rom/lede/config.rockchip-armv8\nfeeds/x/rom/lede/config.sunxi-cortexa7\nfeeds/x/rom/lede/config.x86_64\nfeeds/x/rom/lede/config.x86_64-docker\nfeeds/x/rom/lede/config.x86_generic\n```\n\n## 2. 配置目标\n在上述准备好的模版配置文件的基础上，执行`make menuconfig`命令进行个性化定制，增删应用。\n\n定位到各个子菜单，选择对应的软件包\n![](https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/build//build-m.png)\n\n## 3. 执行编译\n命令:\n```sh\nmake\n```\n或者\n```sh\nmake -j1 V=s\n```\n\n生成的包在`bin/targets/`下面\n\n\n如果需要再次修改配置编译，只要不是换设备，都可以直接 `make menuconfig` 修改后就编译，如果需要修改设备，请从拷贝模版配置的地方重新开始配置。\n\n\n## 3. 高阶配置\n为了得到满意的固件，下面对编译配置选项做更多的详细说明，但是更多的可能并不局限于这些说明内容，还有更多期待大家自己探索。\n\n### 3.1 选择应用\n首先，进入`make menuconfig`菜单\n\n**要编译到固件里面，就要选择`<*>`，如果只选择`<M>`只是编译成软件包`ipk`，不会打包进入固件。**\n\n进入`LuCI - Applications`子菜单下面，选择自己想要的应用\n\n常见的软件包:\n```\nluci-app-aria2 ARRIA2下载工具\nluci-app-ddns DDNS工具\nluci-app-mwan3 MWAN3负载均衡\nluci-app-openvpn OPENVPN\nluci-app-ksmbd Ksmbd文件网络共享（samba文件共享）\nluci-app-upnp UPNP设置\nluci-app-wireguard WireGuard配置界面\nluci-app-natcap 远程界面管理模块和全锥形nat实现模块\nluci-app-natflow-users 用户认证（用户流量显示）模块\n```\n\n进入`Kernel modules - USB Support`菜单，选择USB支持的驱动\n\n进入`Kernel modules - Filesystems`菜单，选择需要支持的文件系统，比如`ext4,ntfs,vfat`等\n\n进入`Kernel modules - Wireless Drivers`菜单，选择无线支持的驱动，如果需要挂卡的驱动，也是在这里找\n\n### 3.2 关于natcap远程管理模块\n这个模块包含这几个方面功能的实现：\n1. 远程界面管理(http://x-wrt.dev/) 模块\n2. 全锥形nat实现模块\n3. 一键VPN功能易用功能\n\n鉴于有些朋友不喜欢远程管理，这里说明下如何去掉这个模块，请自行选择是否需要这个模块。删除后就删除了这个功能包括全锥形nat功能和一键VPN功能，抱歉这些暂时是耦合的无法分离，远程管理界面需要连接中转服务器和报告动态DNS数据，才能生成根据mac地址匹配的动态域名，如果有公网IP才会生成对应的mac域名给一键VPN功能使用。\n\n编译选择不集成这个模块，可以:\n```sh\n# 修改.config文件，删去掉这几个模块\nCONFIG_PACKAGE_luci-app-natcap=y\nCONFIG_PACKAGE_natcapd-client=y\nCONFIG_PACKAGE_natcapd-server=y\nCONFIG_PACKAGE_natcapd=y\nCONFIG_PACKAGE_kmod-natcap=y\n\n# 为了单独让natflow软件加速功能工作，选择下面的包\nCONFIG_PACKAGE_natflow-boot=y\n```","filePath":"src/content/posts/how-to-build-X-WRT.md","digest":"606c751340695281","rendered":{"html":"<p>文章来源：<a href=\"https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/build\" rel=\"nofollow\" target=\"_blank\">https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/build</a></p>\n<section><h1 id=\"编译教程\">编译教程<a class=\"anchor\" href=\"#编译教程\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h1><p>很多人不知道怎样编译一个自己的固件，这里主要简单介绍大概的编译打包流程，具体的情况还需要大家自己发挥，情况千变万化，大家随机应变。</p><section><h2 id=\"1-编译准备\">1 编译准备<a class=\"anchor\" href=\"#1-编译准备\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>我们建议使用<a href=\"https://www.ubuntu.com/\" rel=\"nofollow\" target=\"_blank\">Ubuntu</a>系统作为编译环境，这里以Ubuntu 22.04作为例子，其他版本也是可以的。特别注意的是，整个编译过程，都是用普通用户操作，不要用<code>root</code>用户操作。</p><p>首先要安装编译所需要的软件包:\n<code>sudo apt install build-essential ecj fastjar file flex g++ gcc-multilib g++-multilib gawk gettext git git-core java-propose-classpath libelf-dev libncurses5-dev libncursesw5-dev libssl-dev swig python3 python3-dev python3-distutils python3-pyelftools subversion unzip wget zlib1g-dev rsync qemu-utils</code></p><p>下载源码:</p><div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.4l8yc.css\"><script type=\"module\" src=\"/_astro/ec.g1fg5.js\">\x3C/script><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:75ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">clone</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">https://github.com/x-wrt/x-wrt.git</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#79B8FF;--1:#79B8FF\">cd</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">x-wrt</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#更新代码tag:</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">fetch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">origin</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">fetch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">origin</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">--tags</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#列出可以使用的版本tag:</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">tag</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#注意摁 q 键结束</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#或者直接获取最新发布版本</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">describe</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">--tags</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> $(</span><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">rev-list</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">--tags</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">--max-count=1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">)</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#选择并切换到指定的版本tag:</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">checkout</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-f</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">&#x3C;tag-name></span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#例如</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">checkout</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-f</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">21.10_b202112032317</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#或者</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">checkout</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-f</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> $(</span><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">describe</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">--tags</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> $(</span><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">rev-list</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">--tags</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">--max-count=1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\">))</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#更新代码:</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">./scripts/feeds</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">update</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-a</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">./scripts/feeds</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">install</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-a</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>配置固件的命令<code>make menuconfig</code> 但是我们可以从配置模版开始会更轻松一些。</p><p>比如ramips-mt7621的设备可以用拷贝这个模版<code>feeds/x/rom/lede/config.ramips-mt7621</code>\n内核分区限制小的设备，选用 <code>-nosymbol</code> 结尾的<code>config</code>配置模版</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:48ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">cp</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">feeds/x/rom/lede/config.ramips-mt7621</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">.config</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>由于这些模版是用来编译大量设备的，copy过来后，可以直接编译，不做任何改变。\n但是如果需要改变，需要<code>make menuconfig</code>自定义，就要做下面的操作:</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:53ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\"># 上面已经cp 拷贝了模版配置到 .config</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\"># 例如 cp feeds/x/rom/lede/config.ramips-mt7621 .config</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\"># 下面继续操作和修改</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#1 执行</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">make</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">menuconfig</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#2 进入 Target Profile 选择需要编译打包的设备型号，选择型号后立刻退出，保存</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p><img src=\"https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/build/build-target.png\" alt=\"\"></p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:39ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#3 执行下面的命令修复 .config</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">sh</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">feeds/x/rom/lede/fix-config.sh</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#4 再次执行 make menuconfig 然后立刻退出保存</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\">#5 最后一次 执行 make menuconfig 自定义选择你需要的软件包</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>还有更多配置模版，请参考目录下的<code>config.*</code>文件:</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:46ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ath79-generic</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ath79-generic-nosymbol</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ath79-nand</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.bcm27xx-bcm2709</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.bcm27xx-bcm2710</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.bcm27xx-bcm2711</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.bcm4908-generic</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.bcm53xx-generic</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ipq40xx-generic</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">10</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ipq806x-generic</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">11</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.kirkwood-generic</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">12</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.mediatek-mt7622</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">13</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.mvebu-cortexa53</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">14</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.mvebu-cortexa9</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">15</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ramips-mt7620</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">16</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ramips-mt7620-nosymbol</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">17</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ramips-mt7621</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">18</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ramips-mt76x8</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">19</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ramips-mt76x8-nosymbol</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">20</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ramips-rt305x</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">21</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.ramips-rt3883-nosymbol</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">22</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.rockchip-armv8</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">23</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.sunxi-cortexa7</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">24</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.x86_64</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">25</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.x86_64-docker</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">26</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">feeds/x/rom/lede/config.x86_generic</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section><section><h2 id=\"2-配置目标\">2. 配置目标<a class=\"anchor\" href=\"#2-配置目标\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>在上述准备好的模版配置文件的基础上，执行<code>make menuconfig</code>命令进行个性化定制，增删应用。</p><p>定位到各个子菜单，选择对应的软件包\n<img src=\"https://cdn2.xcqcoo.top/gh/x-wrt/x-wrt.github.io@master/docs/build//build-m.png\" alt=\"\"></p></section><section><h2 id=\"3-执行编译\">3. 执行编译<a class=\"anchor\" href=\"#3-执行编译\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>命令:</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:4ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">make</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>或者</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:12ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">make</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-j1</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">V=s</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>生成的包在<code>bin/targets/</code>下面</p><p>如果需要再次修改配置编译，只要不是换设备，都可以直接 <code>make menuconfig</code> 修改后就编译，如果需要修改设备，请从拷贝模版配置的地方重新开始配置。</p></section><section><h2 id=\"3-高阶配置\">3. 高阶配置<a class=\"anchor\" href=\"#3-高阶配置\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>为了得到满意的固件，下面对编译配置选项做更多的详细说明，但是更多的可能并不局限于这些说明内容，还有更多期待大家自己探索。</p><section><h3 id=\"31-选择应用\">3.1 选择应用<a class=\"anchor\" href=\"#31-选择应用\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>首先，进入<code>make menuconfig</code>菜单</p><p><strong>要编译到固件里面，就要选择<code>&#x3C;*></code>，如果只选择<code>&#x3C;M></code>只是编译成软件包<code>ipk</code>，不会打包进入固件。</strong></p><p>进入<code>LuCI - Applications</code>子菜单下面，选择自己想要的应用</p><p>常见的软件包:</p><div class=\"expressive-code\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"plaintext\" class=\"wrap\" style=\"--ecMaxLine:37ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">luci-app-aria2 ARRIA2下载工具</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">luci-app-ddns DDNS工具</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">luci-app-mwan3 MWAN3负载均衡</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">luci-app-openvpn OPENVPN</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">luci-app-ksmbd Ksmbd文件网络共享（samba文件共享）</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">luci-app-upnp UPNP设置</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">luci-app-wireguard WireGuard配置界面</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">luci-app-natcap 远程界面管理模块和全锥形nat实现模块</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#e1e4e8\">luci-app-natflow-users 用户认证（用户流量显示）模块</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>进入<code>Kernel modules - USB Support</code>菜单，选择USB支持的驱动</p><p>进入<code>Kernel modules - Filesystems</code>菜单，选择需要支持的文件系统，比如<code>ext4,ntfs,vfat</code>等</p><p>进入<code>Kernel modules - Wireless Drivers</code>菜单，选择无线支持的驱动，如果需要挂卡的驱动，也是在这里找</p></section><section><h3 id=\"32-关于natcap远程管理模块\">3.2 关于natcap远程管理模块<a class=\"anchor\" href=\"#32-关于natcap远程管理模块\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h3><p>这个模块包含这几个方面功能的实现：</p><ol>\n<li>远程界面管理(<a href=\"http://x-wrt.dev/\" rel=\"nofollow\" target=\"_blank\">http://x-wrt.dev/</a>) 模块</li>\n<li>全锥形nat实现模块</li>\n<li>一键VPN功能易用功能</li>\n</ol><p>鉴于有些朋友不喜欢远程管理，这里说明下如何去掉这个模块，请自行选择是否需要这个模块。删除后就删除了这个功能包括全锥形nat功能和一键VPN功能，抱歉这些暂时是耦合的无法分离，远程管理界面需要连接中转服务器和报告动态DNS数据，才能生成根据mac地址匹配的动态域名，如果有公网IP才会生成对应的mac域名给一键VPN功能使用。</p><p>编译选择不集成这个模块，可以:</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:32ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\"># 修改.config文件，删去掉这几个模块</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">CONFIG_PACKAGE_luci-app-natcap</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">y</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">CONFIG_PACKAGE_natcapd-client</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">y</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">CONFIG_PACKAGE_natcapd-server</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">y</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">CONFIG_PACKAGE_natcapd</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">y</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">CONFIG_PACKAGE_kmod-natcap</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">y</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span style=\"--0:#99A0A6;--1:#99A0A6\"># 为了单独让natflow软件加速功能工作，选择下面的包</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">9</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">CONFIG_PACKAGE_natflow-boot</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">y</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section></section></section>","metadata":{"headings":[{"depth":1,"slug":"编译教程","text":"编译教程#"},{"depth":2,"slug":"1-编译准备","text":"1 编译准备#"},{"depth":2,"slug":"2-配置目标","text":"2. 配置目标#"},{"depth":2,"slug":"3-执行编译","text":"3. 执行编译#"},{"depth":2,"slug":"3-高阶配置","text":"3. 高阶配置#"},{"depth":3,"slug":"31-选择应用","text":"3.1 选择应用#"},{"depth":3,"slug":"32-关于natcap远程管理模块","text":"3.2 关于natcap远程管理模块#"}],"localImagePaths":[],"remoteImagePaths":[],"frontmatter":{"title":"如何编译X-WRT","published":"2024-08-09T00:00:00.000Z","description":"X-WRT编译教程","image":"../assets/images/x-wrt-logo-min.svg","tags":["x-wrt","X-WRT","openwrt","编译","教程","技术分享、","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":6,"words":1228,"excerpt":"文章来源：https://github.com/x-wrt/x-wrt.github.io/tree/master/docs/build"},"imagePaths":[]}},"collection":"posts","slug":"how-to-build-x-wrt"};
const umamiConfig = {"enable":false,"baseUrl":"","shareId":"","timezone":"Asia/Shanghai"};

    // 获取文章浏览量统计
    async function fetchPostCardViews(slug) {
        if (!umamiConfig.enable) {
            return;
        }
        
        try {
            // 调用全局工具获取 Umami 分享数据
            const { websiteId, token } = await getUmamiShareData(umamiConfig.baseUrl, umamiConfig.shareId);
            
            // 第二步：获取统计数据
            const currentTimestamp = Date.now();
            const statsUrl = `${umamiConfig.baseUrl}/api/websites/${websiteId}/stats?startAt=0&endAt=${currentTimestamp}&unit=hour&timezone=${encodeURIComponent(umamiConfig.timezone)}&path=eq.%2Fposts%2F${slug}%2F&compare=false`;
            
            const statsResponse = await fetch(statsUrl, {
                headers: {
                    'x-umami-share-token': token
                }
            });
            
            if (statsResponse.status === 401) {
                clearUmamiShareCache();
                return await fetchPostCardViews(slug);
            }
            
            if (!statsResponse.ok) {
                throw new Error('获取统计数据失败');
            }
            
            const statsData = await statsResponse.json();
            const pageViews = statsData.pageviews || 0;
            const visits = statsData.visitors || 0;
            
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
             if (viewsElement) {
                 viewsElement.textContent = pageViews;
             }
             if (visitorsElement) {
                 visitorsElement.textContent = visits;
             }
        } catch (error) {
            console.error('Error fetching page views for', slug, ':', error);
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
            if (viewsElement) {
                viewsElement.textContent = '-';
            }
            if (visitorsElement) {
                visitorsElement.textContent = '-';
            }
        }
    }

    // 页面加载完成后获取统计数据
    function initPostCardStats() {
        const slug = entry.slug;
        if (slug) {
            fetchPostCardViews(slug);
        }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initPostCardStats);
    } else {
        initPostCardStats();
    }
})();</script> <div class="card-base flex flex-col-reverse md:flex-col w-full rounded-[var(--radius-large)] overflow-hidden relative onload-animation" style="animation-delay: calc(var(--content-delay) + 250ms);; --coverWidth: 28%;" data-astro-cid-iyiqi2so> <div class="pl-6 md:pl-9 pr-6 md:pr-2 pt-6 md:pt-7 pb-6 relative w-full md:w-[calc(100%_-_var(--coverWidth)_-_12px)]" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <a href="/posts/diy-openwrt/" class="transition group w-full block font-bold mb-3 text-3xl text-90
        hover:text-[var(--primary)] dark:hover:text-[var(--primary)]
        active:text-[var(--title-active)] dark:active:text-[var(--title-active)]
        before:w-1 before:h-5 before:rounded-md before:bg-[var(--primary)]
        before:absolute before:top-[35px] before:left-[18px] before:hidden md:before:block
        " data-astro-cid-iyiqi2so style="--coverWidth: 28%;">  自己动手编译 OpenWRT <svg width="1em" height="1em" viewBox="0 0 24 24" class="inline text-[2rem] text-[var(--primary)] md:hidden translate-y-0.5 absolute" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-[var(--primary)] text-[2rem] transition hidden md:inline absolute translate-y-0.5 opacity-0 group-hover:opacity-100 -translate-x-1 group-hover:translate-x-0" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </a> <!-- metadata --> <div class="flex flex-wrap text-neutral-500 dark:text-neutral-400 items-center gap-4 gap-x-4 gap-y-2 mb-4"> <!-- publish date --> <div class="flex items-center"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:calendar-today-outline-rounded">   <use href="#ai:material-symbols:calendar-today-outline-rounded"></use>  </svg> </div> <span class="text-50 text-sm font-medium">2024-08-08</span> </div> <!-- update date -->  <!-- tags --> <div class="items-center hidden md:flex"> <div class="meta-icon"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-xl" data-icon="material-symbols:tag-rounded">   <use href="#ai:material-symbols:tag-rounded"></use>  </svg> </div> <div class="flex flex-row flex-nowrap items-center"> <div class="hidden mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/openwrt/" aria-label="View all posts with the openwrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> openwrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/编译/" aria-label="View all posts with the 编译 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 编译 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/OpenWrt/" aria-label="View all posts with the OpenWrt tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> OpenWrt </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/教程/" aria-label="View all posts with the 教程 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 教程 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/技术分享/" aria-label="View all posts with the 技术分享 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 技术分享 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/网络/" aria-label="View all posts with the 网络 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 网络 </a><div class="mx-1.5 text-[var(--meta-divider)] text-sm">/</div>
                <a href="/archive/tag/路由器/" aria-label="View all posts with the 路由器 tag" class="link-lg transition text-50 text-sm font-medium
                                hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"> 路由器 </a>  </div> </div> <!-- page views & visitors -->  </div>  <!-- description --> <div class="transition text-75 mb-3.5 pr-4" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> 如何自己编译OpenWrt </div> <!-- word count, read time and page views --> <div class="text-sm text-black/30 dark:text-white/30 flex gap-4 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">1383 字</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">7 分钟</div> <div data-astro-cid-iyiqi2so style="--coverWidth: 28%;">|</div> <div class="flex items-center gap-2" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:visibility-outline">   <use href="#ai:material-symbols:visibility-outline"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-views-diy-openwrt" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> <div class="flex items-center gap-1" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-base" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:person">   <use href="#ai:material-symbols:person"></use>  </svg> <span class="text-50 text-sm font-medium" id="page-visitors-diy-openwrt" data-astro-cid-iyiqi2so style="--coverWidth: 28%;">-</span> </div> </div> </div> </div> <a href="/posts/diy-openwrt/" aria-label="自己动手编译 OpenWRT" class="group max-h-[20vh] md:max-h-none mx-4 mt-4 -mb-2 md:mb-0 md:mx-0 md:mt-0 md:w-[var(--coverWidth)] relative md:absolute md:top-3 md:bottom-3 md:right-3 rounded-xl overflow-hidden active:scale-95" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <div class="absolute pointer-events-none z-10 w-full h-full group-hover:bg-black/30 group-active:bg-black/50 transition" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <!-- 封面图上的箭头 --> <div class="absolute pointer-events-none z-20 w-full h-full flex items-center justify-center " data-astro-cid-iyiqi2so style="--coverWidth: 28%;"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="transition opacity-0 group-hover:opacity-100 scale-50 group-hover:scale-100 text-white text-5xl" data-astro-cid-iyiqi2so="true" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </div> <div class="w-full h-full overflow-hidden relative image-wrapper" style="--theme-hue: 215" data-astro-cid-i2xmscho> <!-- 加载条 --> <div class="loading-bar absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-1 bg-gray-200 dark:bg-gray-700 z-10 rounded-full overflow-hidden" data-astro-cid-i2xmscho> <div class="loading-progress h-full w-8 bg-[oklch(0.70_0.14_var(--theme-hue))] animate-loading-progress rounded-full" data-astro-cid-i2xmscho></div> </div> <!-- 图片内容 --> <img src="/_astro/openwrt-1.DpJkZGqM_1LlYpO.webp" alt="Cover Image of the Post" style="object-position: center" onload="this.style.opacity='1'; this.parentElement.querySelector('.loading-bar').style.opacity='0';" data-astro-cid-i2xmscho="true" width="200" height="200" loading="lazy" decoding="async" class="w-full h-full object-cover image-content opacity-0 transition-opacity duration-500">  </div>  </a>  </div> <div class="transition border-t-[1px] border-dashed mx-6 border-black/10 dark:border-white/[0.15] last:border-t-0 md:hidden" data-astro-cid-iyiqi2so style="--coverWidth: 28%;"></div> <script>(function(){const entry = {"id":"diy-OpenWRT.md","data":{"title":"自己动手编译 OpenWRT","published":"2024-08-08T00:00:00.000Z","description":"如何自己编译OpenWrt","image":"../assets/images/openwrt-1.png","tags":["openwrt","编译","OpenWrt","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":7,"words":1383,"excerpt":"文章来源：https://lgiki.net/post/compile-openwrt/","nextSlug":"how-to-build-x-wrt","nextTitle":"如何编译X-WRT"},"body":"文章来源：https://lgiki.net/post/compile-openwrt/\n\n## Intro\n\n学校最近升级了校园网设备，终于从年久失修的龟速 100Mbps 升级到了 1Gbps，尽管还是使用锐捷的 ePortal 网页认证，还能通过简单的 Shell 脚本在路由器上自动认证，但新设备却限制了每个用户最多只能同时有两台设备在线，使用路由器会被检测出使用多设备，并被加入黑名单，被断网。\n\n\n都 2023 年了，随便手机、电脑再加个平板就仨设备了，更不用说可能还有 Kindle、Switch 等其他设备，只能同时两台设备在线怎么可能满足学生正常使用校园网的需求。更何况，计算机专业的学生可能还会使用虚拟机等软件，但虚拟机类的软件也可能被检测为是多设备同时在线，所以你让计算机专业的学生拿啥学习呢，内存条含嘴里脑补画面吗？\n\n\n限制校园网的同时在线设备数量无非就两个出发点：（1）如果不限制，一个宿舍只需要开通一个宽带账号，所有人都可以上网了，运营商的收入就减少了；（2）如果学生出现一些非法的上网行为，可以快速准确地定位到具体学生。但我觉得这都不是学校限制学生只能使用两个设备的理由，哪怕提升到 5 个设备我觉得也合理一些。\n\n对于限制校园网设备数量的学校，我只能说 Shame on you！\n\n对于限制校园网设备数量的学校，我只能说 Shame on you！\n\n对于限制校园网设备数量的学校，我只能说 Shame on you！\n\n那就…只能另辟蹊径，想其他办法了。\n\n还好，限制同时在线设备数量这件事早已有其他学校实施过了，也已经有人提出了一些对策。\n例如，在 https://blog.sunbk201.site/posts/crack-campus-network 这篇博客里就详细列举了校园网检测在线设备可能采用的手段以及相应的应对措施，我们只需要照着做就行了。\n\n其实主要就是为 OpenWRT 编译 [rkp-ipid](https://github.com/CHN-beta/rkp-ipid) 和 [UA2F](https://github.com/Zxilly/UA2F) 这两个包，而这两个包需要在编译内核的时候开启一些选项，所以需要重新编译 OpenWRT 固件，也因此写下这篇文章记录一下编译 OpenWRT 的过程。\n\n## 安装编译环境\n\n要编译 Linux 当然是使用 Linux 啦！\n\n如果是 Debian 系的发行版（例如 Ubuntu），可以使用以下指令来安装编译所需的依赖：\n```sh\nsudo apt update -y\nsudo apt full-upgrade -y\nsudo apt install -y ack antlr3 aria2 asciidoc autoconf automake autopoint binutils bison build-essential \\\nbzip2 ccache cmake cpio curl device-tree-compiler fastjar flex gawk gettext gcc-multilib g++-multilib \\\ngit gperf haveged help2man intltool libc6-dev-i386 libelf-dev libglib2.0-dev libgmp3-dev libltdl-dev \\\nlibmpc-dev libmpfr-dev libncurses5-dev libncursesw5-dev libreadline-dev libssl-dev libtool lrzsz \\\nmkisofs msmtp nano ninja-build p7zip p7zip-full patch pkgconf python2.7 python3 python3-pip libpython3-dev qemu-utils \\\nrsync scons squashfs-tools subversion swig texinfo uglifyjs upx-ucl unzip vim wget xmlto xxd zlib1g-dev\n```\n对于 Arch 系的发行版，直接安装 AUR 中的 openwrt-devel 即可：\nhttps://aur.archlinux.org/packages/openwrt-devel\n\n## 获取 OpenWRT 源码\n\n如果你的设备是 OpenWRT 官方支持的设备，并且你想编译 OpenWRT 官方源码，则直接：\n```sh\ngit clone https://github.com/openwrt/openwrt.git\n```\n即可。\n\n但现在有一些国产的路由器 OpenWRT 官方并不支持，可以看看有没有第三方的 OpenWRT 源码支持了你手上的路由器，下载相应的源代码。\n可以通过`cat /etc/openwrt_release`命令来查看设备的 Arch、Target 信息：\n```sh\nroot@QWRT:~# cat /etc/openwrt_release\nDISTRIB_ID='OpenWrt'\nDISTRIB_RELEASE='19.07-SNAPSHOT'\nDISTRIB_TARGET='ipq60xx/generic'\nDISTRIB_ARCH='aarch64_cortex-a53+crypto'\nDISTRIB_TAINTS='no-all busybox override'\nDISTRIB_REVISION='R23.1.20'\nDISTRIB_DESCRIPTION='QWRT '\n```\n获取了 OpenWRT 源代码之后需要更新 Feeds：\n```sh\ncd openwrt\n./scripts/feeds update -a\n./scripts/feeds install -a\n```\n\n## 添加想要编译的第三方包 (可选)\n\n因为我需要编译 rkp-ipid 和 UA2F，因此我还需要将这些包的源码下载下来：\n```sh\ngit clone https://github.com/CHN-beta/rkp-ipid package/rkp-ipid\ngit clone https://github.com/Zxilly/UA2F package/UA2F\n```\n\n## 配置编译目标\n\n一切准备就绪，接下来就是设定编译目标了，执行以下命令：\n```sh\nmake menuconfig\n```\n然后会出现一个命令行 UI，首先需要重点设定好`Target System`,`Subtarget`,`Target Profile`，将这几个项目设定为你的路由器。 然后就可以选择你需要编译的包啦，使用空格可以选择要编译的包，设定为 <*> 的包将会内置到固件里，刷好就能直接用，设定为 <M> 的包将会编译成 ipk 文件，需要上传到路由器，然后使用`opkg install package_name.ipk`进行安装。\n\n设定好了之后，将配置文件保存为`.config`即可，如果有一些包需要对内核做一些自定义，也可以直接使用文本编辑器编辑保存下来的`.config`文件，例如`UA2F`就需要添加`CONFIG_NETFILTER_NETLINK_GLUE_CT=y`。\n\n## 开始编译\n\n一切准备完毕，接下来开始编译！\n```sh\nmake download -j8\nmake V=s -j8\n```\n其中`V=s`表示输出`stdout`和`stderr`，方便在编译失败的时候根据输出信息确定是哪里的错误，`-jn`的`n`表示使用`n`个线程同时编译，对于核心数较多的机器可以将该数值设置得大一些，加快编译过程。\n\n编译完成之后，在`./bin/targets`下就可以找到固件以及相应的`ipk`包了。\n\n## UA2F 的注意事项\n\n要使 UA2F 正常工作需要关闭 “网络”——“Turbo ACC 网络加速设置” 下的所有选项，否则 UA2F 无法正常工作，具体表现为：重启路由器防火墙之后，第一次 HTTP 请求的 User-Agent 成功修改，但后续 HTTP 请求的 User-Agent 没有被修改。","filePath":"src/content/posts/diy-OpenWRT.md","digest":"dd80d4ec308bf1a2","rendered":{"html":"<p>文章来源：<a href=\"https://lgiki.net/post/compile-openwrt/\" rel=\"nofollow\" target=\"_blank\">https://lgiki.net/post/compile-openwrt/</a></p>\n<section><h2 id=\"intro\">Intro<a class=\"anchor\" href=\"#intro\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>学校最近升级了校园网设备，终于从年久失修的龟速 100Mbps 升级到了 1Gbps，尽管还是使用锐捷的 ePortal 网页认证，还能通过简单的 Shell 脚本在路由器上自动认证，但新设备却限制了每个用户最多只能同时有两台设备在线，使用路由器会被检测出使用多设备，并被加入黑名单，被断网。</p><p>都 2023 年了，随便手机、电脑再加个平板就仨设备了，更不用说可能还有 Kindle、Switch 等其他设备，只能同时两台设备在线怎么可能满足学生正常使用校园网的需求。更何况，计算机专业的学生可能还会使用虚拟机等软件，但虚拟机类的软件也可能被检测为是多设备同时在线，所以你让计算机专业的学生拿啥学习呢，内存条含嘴里脑补画面吗？</p><p>限制校园网的同时在线设备数量无非就两个出发点：（1）如果不限制，一个宿舍只需要开通一个宽带账号，所有人都可以上网了，运营商的收入就减少了；（2）如果学生出现一些非法的上网行为，可以快速准确地定位到具体学生。但我觉得这都不是学校限制学生只能使用两个设备的理由，哪怕提升到 5 个设备我觉得也合理一些。</p><p>对于限制校园网设备数量的学校，我只能说 Shame on you！</p><p>对于限制校园网设备数量的学校，我只能说 Shame on you！</p><p>对于限制校园网设备数量的学校，我只能说 Shame on you！</p><p>那就…只能另辟蹊径，想其他办法了。</p><p>还好，限制同时在线设备数量这件事早已有其他学校实施过了，也已经有人提出了一些对策。\n例如，在 <a href=\"https://blog.sunbk201.site/posts/crack-campus-network\" rel=\"nofollow\" target=\"_blank\">https://blog.sunbk201.site/posts/crack-campus-network</a> 这篇博客里就详细列举了校园网检测在线设备可能采用的手段以及相应的应对措施，我们只需要照着做就行了。</p><p>其实主要就是为 OpenWRT 编译 <a href=\"https://github.com/CHN-beta/rkp-ipid\" rel=\"nofollow\" target=\"_blank\">rkp-ipid</a> 和 <a href=\"https://github.com/Zxilly/UA2F\" rel=\"nofollow\" target=\"_blank\">UA2F</a> 这两个包，而这两个包需要在编译内核的时候开启一些选项，所以需要重新编译 OpenWRT 固件，也因此写下这篇文章记录一下编译 OpenWRT 的过程。</p></section>\n<section><h2 id=\"安装编译环境\">安装编译环境<a class=\"anchor\" href=\"#安装编译环境\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>要编译 Linux 当然是使用 Linux 啦！</p><p>如果是 Debian 系的发行版（例如 Ubuntu），可以使用以下指令来安装编译所需的依赖：</p><div class=\"expressive-code\"><link rel=\"stylesheet\" href=\"/_astro/ec.4l8yc.css\"><script type=\"module\" src=\"/_astro/ec.g1fg5.js\">\x3C/script><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:119ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">sudo</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">apt</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">update</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-y</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">sudo</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">apt</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">full-upgrade</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-y</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">sudo</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">apt</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">install</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-y</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">ack</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">antlr3</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">aria2</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">asciidoc</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">autoconf</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">automake</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">autopoint</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">binutils</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">bison</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">build-essential</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">bzip2 </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">ccache</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">cmake</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">cpio</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">curl</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">device-tree-compiler</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">fastjar</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">flex</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">gawk</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">gettext</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">gcc-multilib</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">g++-multilib</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">git </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">gperf</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">haveged</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">help2man</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">intltool</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libc6-dev-i386</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libelf-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libglib2.0-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libgmp3-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libltdl-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">libmpc-dev </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libmpfr-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libncurses5-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libncursesw5-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libreadline-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libssl-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libtool</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">lrzsz</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">mkisofs </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">msmtp</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">nano</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">ninja-build</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">p7zip</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">p7zip-full</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">patch</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">pkgconf</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">python2.7</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">python3</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">python3-pip</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">libpython3-dev</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">qemu-utils</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">\\</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">rsync </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">scons</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">squashfs-tools</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">subversion</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">swig</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">texinfo</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">uglifyjs</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">upx-ucl</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">unzip</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">vim</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">wget</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">xmlto</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">xxd</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">zlib1g-dev</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>对于 Arch 系的发行版，直接安装 AUR 中的 openwrt-devel 即可：\n<a href=\"https://aur.archlinux.org/packages/openwrt-devel\" rel=\"nofollow\" target=\"_blank\">https://aur.archlinux.org/packages/openwrt-devel</a></p></section>\n<section><h2 id=\"获取-openwrt-源码\">获取 OpenWRT 源码<a class=\"anchor\" href=\"#获取-openwrt-源码\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>如果你的设备是 OpenWRT 官方支持的设备，并且你想编译 OpenWRT 官方源码，则直接：</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:48ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">clone</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">https://github.com/openwrt/openwrt.git</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>即可。</p><p>但现在有一些国产的路由器 OpenWRT 官方并不支持，可以看看有没有第三方的 OpenWRT 源码支持了你手上的路由器，下载相应的源代码。\n可以通过<code>cat /etc/openwrt_release</code>命令来查看设备的 Arch、Target 信息：</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:40ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">root@QWRT:~#</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">cat</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">/etc/openwrt_release</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">DISTRIB_ID</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'OpenWrt'</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">DISTRIB_RELEASE</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'19.07-SNAPSHOT'</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">4</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">DISTRIB_TARGET</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'ipq60xx/generic'</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">5</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">DISTRIB_ARCH</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'aarch64_cortex-a53+crypto'</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">6</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">DISTRIB_TAINTS</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'no-all busybox override'</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">7</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">DISTRIB_REVISION</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'R23.1.20'</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">8</div></div><div class=\"code\"><span style=\"--0:#E1E4E8;--1:#E1E4E8\">DISTRIB_DESCRIPTION</span><span style=\"--0:#F97583;--1:#F97583\">=</span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">'QWRT '</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>获取了 OpenWRT 源代码之后需要更新 Feeds：</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:26ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#79B8FF;--1:#79B8FF\">cd</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">openwrt</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">./scripts/feeds</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">update</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-a</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">3</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">./scripts/feeds</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">install</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-a</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section>\n<section><h2 id=\"添加想要编译的第三方包-可选\">添加想要编译的第三方包 (可选)<a class=\"anchor\" href=\"#添加想要编译的第三方包-可选\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>因为我需要编译 rkp-ipid 和 UA2F，因此我还需要将这些包的源码下载下来：</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:63ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">clone</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">https://github.com/CHN-beta/rkp-ipid</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">package/rkp-ipid</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">git</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">clone</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">https://github.com/Zxilly/UA2F</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">package/UA2F</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div></section>\n<section><h2 id=\"配置编译目标\">配置编译目标<a class=\"anchor\" href=\"#配置编译目标\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>一切准备就绪，接下来就是设定编译目标了，执行以下命令：</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:15ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">make</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">menuconfig</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>然后会出现一个命令行 UI，首先需要重点设定好<code>Target System</code>,<code>Subtarget</code>,<code>Target Profile</code>，将这几个项目设定为你的路由器。 然后就可以选择你需要编译的包啦，使用空格可以选择要编译的包，设定为 &#x3C;*> 的包将会内置到固件里，刷好就能直接用，设定为 <m> 的包将会编译成 ipk 文件，需要上传到路由器，然后使用<code>opkg install package_name.ipk</code>进行安装。</m></p><p>设定好了之后，将配置文件保存为<code>.config</code>即可，如果有一些包需要对内核做一些自定义，也可以直接使用文本编辑器编辑保存下来的<code>.config</code>文件，例如<code>UA2F</code>就需要添加<code>CONFIG_NETFILTER_NETLINK_GLUE_CT=y</code>。</p></section>\n<section><h2 id=\"开始编译\">开始编译<a class=\"anchor\" href=\"#开始编译\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>一切准备完毕，接下来开始编译！</p><div class=\"expressive-code\"><figure class=\"frame is-terminal\"><figcaption class=\"header\"><span class=\"title\"></span><span class=\"sr-only\">Terminal window</span></figcaption><pre data-language=\"sh\" class=\"wrap\" style=\"--ecMaxLine:17ch\"><code><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">1</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">make</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">download</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-j8</span></div></div><div class=\"ec-line\"><div class=\"gutter\"><div class=\"ln\" aria-hidden=\"true\">2</div></div><div class=\"code\"><span style=\"--0:#B392F0;--1:#B392F0\">make</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#9ECBFF;--1:#9ECBFF\">V=s</span><span style=\"--0:#E1E4E8;--1:#E1E4E8\"> </span><span style=\"--0:#79B8FF;--1:#79B8FF\">-j8</span></div></div></code><button class=\"copy-btn\" aria-label=\"Copy code\"><div class=\"copy-btn-icon\"><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon copy-icon\"><path d=\"M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-515.76q0-17.45 11.96-29.48 11.97-12.02 29.33-12.02t29.54 12.02q12.17 12.03 12.17 29.48v515.76h419.76q17.45 0 29.48 11.96 12.02 11.97 12.02 29.33t-12.02 29.54q-12.03 12.17-29.48 12.17H213.37Zm155-238v-474.26 474.26Z\"></path></svg><svg viewBox=\"0 -960 960 960\" xmlns=\"http://www.w3.org/2000/svg\" class=\"copy-btn-icon success-icon\"><path d=\"m389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z\"></path></svg></div></button></pre></figure></div><p>其中<code>V=s</code>表示输出<code>stdout</code>和<code>stderr</code>，方便在编译失败的时候根据输出信息确定是哪里的错误，<code>-jn</code>的<code>n</code>表示使用<code>n</code>个线程同时编译，对于核心数较多的机器可以将该数值设置得大一些，加快编译过程。</p><p>编译完成之后，在<code>./bin/targets</code>下就可以找到固件以及相应的<code>ipk</code>包了。</p></section>\n<section><h2 id=\"ua2f-的注意事项\">UA2F 的注意事项<a class=\"anchor\" href=\"#ua2f-的注意事项\"><span class=\"anchor-icon\" data-pagefind-ignore=\"\">#</span></a></h2><p>要使 UA2F 正常工作需要关闭 “网络”——“Turbo ACC 网络加速设置” 下的所有选项，否则 UA2F 无法正常工作，具体表现为：重启路由器防火墙之后，第一次 HTTP 请求的 User-Agent 成功修改，但后续 HTTP 请求的 User-Agent 没有被修改。</p></section>","metadata":{"headings":[{"depth":2,"slug":"intro","text":"Intro#"},{"depth":2,"slug":"安装编译环境","text":"安装编译环境#"},{"depth":2,"slug":"获取-openwrt-源码","text":"获取 OpenWRT 源码#"},{"depth":2,"slug":"添加想要编译的第三方包-可选","text":"添加想要编译的第三方包 (可选)#"},{"depth":2,"slug":"配置编译目标","text":"配置编译目标#"},{"depth":2,"slug":"开始编译","text":"开始编译#"},{"depth":2,"slug":"ua2f-的注意事项","text":"UA2F 的注意事项#"}],"localImagePaths":[],"remoteImagePaths":[],"frontmatter":{"title":"自己动手编译 OpenWRT","published":"2024-08-08T00:00:00.000Z","description":"如何自己编译OpenWrt","image":"../assets/images/openwrt-1.png","tags":["openwrt","编译","OpenWrt","教程","技术分享","网络","路由器"],"category":"路由器","draft":false,"lang":"","minutes":7,"words":1383,"excerpt":"文章来源：https://lgiki.net/post/compile-openwrt/"},"imagePaths":[]}},"collection":"posts","slug":"diy-openwrt"};
const umamiConfig = {"enable":false,"baseUrl":"","shareId":"","timezone":"Asia/Shanghai"};

    // 获取文章浏览量统计
    async function fetchPostCardViews(slug) {
        if (!umamiConfig.enable) {
            return;
        }
        
        try {
            // 调用全局工具获取 Umami 分享数据
            const { websiteId, token } = await getUmamiShareData(umamiConfig.baseUrl, umamiConfig.shareId);
            
            // 第二步：获取统计数据
            const currentTimestamp = Date.now();
            const statsUrl = `${umamiConfig.baseUrl}/api/websites/${websiteId}/stats?startAt=0&endAt=${currentTimestamp}&unit=hour&timezone=${encodeURIComponent(umamiConfig.timezone)}&path=eq.%2Fposts%2F${slug}%2F&compare=false`;
            
            const statsResponse = await fetch(statsUrl, {
                headers: {
                    'x-umami-share-token': token
                }
            });
            
            if (statsResponse.status === 401) {
                clearUmamiShareCache();
                return await fetchPostCardViews(slug);
            }
            
            if (!statsResponse.ok) {
                throw new Error('获取统计数据失败');
            }
            
            const statsData = await statsResponse.json();
            const pageViews = statsData.pageviews || 0;
            const visits = statsData.visitors || 0;
            
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
             if (viewsElement) {
                 viewsElement.textContent = pageViews;
             }
             if (visitorsElement) {
                 visitorsElement.textContent = visits;
             }
        } catch (error) {
            console.error('Error fetching page views for', slug, ':', error);
            const viewsElement = document.getElementById(`page-views-${slug}`);
            const visitorsElement = document.getElementById(`page-visitors-${slug}`);
            if (viewsElement) {
                viewsElement.textContent = '-';
            }
            if (visitorsElement) {
                visitorsElement.textContent = '-';
            }
        }
    }

    // 页面加载完成后获取统计数据
    function initPostCardStats() {
        const slug = entry.slug;
        if (slug) {
            fetchPostCardViews(slug);
        }
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initPostCardStats);
    } else {
        initPostCardStats();
    }
})();</script>  </div> <div class="mx-auto onload-animation flex flex-row gap-3 justify-center" style="animation-delay: calc(var(--content-delay) + 300ms)"> <a href class="btn-card overflow-hidden rounded-lg text-[var(--primary)] w-11 h-11 disabled"> <svg width="1em" height="1em" class="text-[1.75rem]" data-icon="material-symbols:chevron-left-rounded">   <symbol id="ai:material-symbols:chevron-left-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z"/></symbol><use href="#ai:material-symbols:chevron-left-rounded"></use>  </svg> </a> <div class="bg-[var(--card-bg)] flex flex-row rounded-lg items-center text-neutral-700 dark:text-neutral-300 font-bold"> <div class="h-11 w-11 rounded-lg bg-[var(--primary)] flex items-center justify-center
                    font-bold text-white dark:text-black/70"> 1 </div> </div> <a href class="btn-card overflow-hidden rounded-lg text-[var(--primary)] w-11 h-11 disabled"> <svg width="1em" height="1em" viewBox="0 0 24 24" class="text-[1.75rem]" data-icon="material-symbols:chevron-right-rounded">   <use href="#ai:material-symbols:chevron-right-rounded"></use>  </svg> </a> </div>  <div class="footer col-span-2 onload-animation hidden lg:block"> <!--<div class="border-t border-[var(&#45;&#45;primary)] mx-16 border-dashed py-8 max-w-[var(&#45;&#45;page-width)] flex flex-col items-center justify-center px-6">--><div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-32"></div> <!--<div class="transition bg-[oklch(92%_0.01_var(&#45;&#45;hue))] dark:bg-black rounded-2xl py-8 mt-4 mb-8 flex flex-col items-center justify-center px-6">--> <div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-6"> <div class="transition text-50 text-sm text-center">
&copy; <span id="copyright-year">2024 - 2025</span> <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://space.bilibili.com/510234024"> QC3284 </a>，采用
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可
<br> <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="/rss.xml">RSS</a> /
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="/sitemap-index.xml">网站地图</a> <br>
由
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> 和
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/saicaca/fuwari">Fuwari</a> 强力驱动
<br>
本网站代码
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/qc3284/afo-fuwari">已开源</a> <br> <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://icp.gov.moe/?keyword=20250129/">萌ICP备20250129号</a> <br> <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://www.netlify.com/">This site is powered by Netlify</a> <br> <!-- 这里是运行时间的位置 --> <div id="runningtime" class="my-2 text-sm text-gray-600 dark:text-gray-400"></div> <!-- 这里放 JavaScript 代码 --> <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
            function runtime() {
                const runningTimeElement = document.getElementById("runningtime");
                if (!runningTimeElement) return;

                const t = new Date("07/21/2024 08:00:00"),
                      n = new Date(),
                      s = n - t,
                      e = Math.floor(s / 1000),
                      o = Math.floor(e / 86400),
                      i = Math.floor(e % 86400 / 3600),
                      a = Math.floor(e % 3600 / 60),
                      r = e % 60;

                runningTimeElement.innerHTML = `⭐本站已运行: ${o}天${i}小时${a}分${r}秒 ☁️`;
            }

            runtime(); // 立即执行一次
            setInterval(runtime, 1000);
        });
        </script> </div> </div> </div> </div> </main> <div class="footer col-span-2 onload-animation block lg:hidden"> <!--<div class="border-t border-[var(&#45;&#45;primary)] mx-16 border-dashed py-8 max-w-[var(&#45;&#45;page-width)] flex flex-col items-center justify-center px-6">--><div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-32"></div> <!--<div class="transition bg-[oklch(92%_0.01_var(&#45;&#45;hue))] dark:bg-black rounded-2xl py-8 mt-4 mb-8 flex flex-col items-center justify-center px-6">--> <div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-6"> <div class="transition text-50 text-sm text-center">
&copy; <span id="copyright-year">2024 - 2025</span> <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://space.bilibili.com/510234024"> QC3284 </a>，采用
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可
<br> <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="/rss.xml">RSS</a> /
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="/sitemap-index.xml">网站地图</a> <br>
由
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> 和
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/saicaca/fuwari">Fuwari</a> 强力驱动
<br>
本网站代码
<a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/qc3284/afo-fuwari">已开源</a> <br> <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://icp.gov.moe/?keyword=20250129/">萌ICP备20250129号</a> <br> <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://www.netlify.com/">This site is powered by Netlify</a> <br> <!-- 这里是运行时间的位置 --> <div id="runningtime" class="my-2 text-sm text-gray-600 dark:text-gray-400"></div> <!-- 这里放 JavaScript 代码 --> <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
            function runtime() {
                const runningTimeElement = document.getElementById("runningtime");
                if (!runningTimeElement) return;

                const t = new Date("07/21/2024 08:00:00"),
                      n = new Date(),
                      s = n - t,
                      e = Math.floor(s / 1000),
                      o = Math.floor(e / 86400),
                      i = Math.floor(e % 86400 / 3600),
                      a = Math.floor(e % 3600 / 60),
                      r = e % 60;

                runningTimeElement.innerHTML = `⭐本站已运行: ${o}天${i}小时${a}分${r}秒 ☁️`;
            }

            runtime(); // 立即执行一次
            setInterval(runtime, 1000);
        });
        </script> </div> </div> </div> </div> <!-- There can't be a filter on parent element, or it will break `fixed` --><div class="back-to-top-wrapper hidden lg:block" data-astro-cid-eymb5ayk> <div id="back-to-top-btn" class="back-to-top-btn hide flex items-center rounded-2xl overflow-hidden transition" onclick="backToTop()" data-astro-cid-eymb5ayk> <button aria-label="Back to Top" class="btn-card h-[3.75rem] w-[3.75rem]" data-astro-cid-eymb5ayk> <svg width="1em" height="1em" class="mx-auto" data-astro-cid-eymb5ayk="true" data-icon="material-symbols:keyboard-arrow-up-rounded">   <symbol id="ai:material-symbols:keyboard-arrow-up-rounded" viewBox="0 0 24 24"><path fill="currentColor" d="m12 10.8l-3.9 3.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.6-4.6q.3-.3.7-.3t.7.3l4.6 4.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275z"/></symbol><use href="#ai:material-symbols:keyboard-arrow-up-rounded"></use>  </svg> </button> </div> </div>  <script>
function backToTop() {
    window.scroll({ top: 0, behavior: 'smooth' });
}
</script> </div> </div>  <div class="absolute w-full z-0 hidden 2xl:block"> <div class="relative max-w-[var(--page-width)] mx-auto"> <!-- TOC component --> <div id="toc-wrapper" class="hidden lg:block transition absolute top-0 -right-[var(--toc-width)] w-[var(--toc-width)] flex items-center"> <div id="toc-inner-wrapper" class="fixed top-14 w-[var(--toc-width)] h-[calc(100vh_-_20rem)] overflow-y-scroll overflow-x-hidden hide-scrollbar"> <div id="toc" class="w-full h-full transition-swup-fade "> <div class="h-8 w-full"></div> <script type="module">class l extends HTMLElement{tocEl=null;visibleClass="visible";observer;anchorNavTarget=null;headingIdxMap=new Map;headings=[];sections=[];tocEntries=[];active=[];activeIndicator=null;constructor(){super(),this.observer=new IntersectionObserver(this.markVisibleSection,{threshold:0})}markVisibleSection=t=>{if(t.forEach(e=>{const i=e.target.children[0]?.getAttribute("id"),s=i?this.headingIdxMap.get(i):void 0;s!=null&&(this.active[s]=e.isIntersecting),e.isIntersecting&&this.anchorNavTarget==e.target.firstChild&&(this.anchorNavTarget=null)}),!this.active.includes(!0)){this.activeIndicator?.setAttribute("style","display: none;"),this.fallback();return}this.update()};toggleActiveHeading=()=>{let t=this.active.length-1,e=this.active.length-1,i=0;for(;t>=0&&!this.active[t];)this.tocEntries[t].classList.remove(this.visibleClass),t--;for(;t>=0&&this.active[t];)this.tocEntries[t].classList.add(this.visibleClass),e=Math.min(e,t),i=Math.max(i,t),t--;for(;t>=0;)this.tocEntries[t].classList.remove(this.visibleClass),t--;let s=this.tocEl?.getBoundingClientRect().top||0,n=this.tocEl?.scrollTop||0,o=this.tocEntries[e].getBoundingClientRect().top-s+n,c=this.tocEntries[i].getBoundingClientRect().bottom-s+n;this.activeIndicator?.setAttribute("style",`display: block; top: ${o}px; height: ${c-o}px`)};scrollToActiveHeading=()=>{if(this.anchorNavTarget||!this.tocEl)return;const t=document.querySelectorAll(`#toc .${this.visibleClass}`);if(!t.length)return;const e=t[0],i=t[t.length-1],s=this.tocEl.clientHeight;let n;i.getBoundingClientRect().bottom-e.getBoundingClientRect().top<.9*s?n=e.offsetTop-32:n=i.offsetTop-s*.8,this.tocEl.scrollTo({top:n,left:0,behavior:"smooth"})};update=()=>{requestAnimationFrame(()=>{this.toggleActiveHeading(),this.scrollToActiveHeading()})};fallback=()=>{if(this.sections.length)for(let t=0;t<this.sections.length;t++){let e=this.sections[t].getBoundingClientRect().top,i=this.sections[t].getBoundingClientRect().bottom;if(this.isInRange(e,0,window.innerHeight)||this.isInRange(i,0,window.innerHeight)||e<0&&i>window.innerHeight)this.markActiveHeading(t);else if(e>window.innerHeight)break}};markActiveHeading=t=>{this.active[t]=!0};handleAnchorClick=t=>{const e=t.composedPath().find(i=>i instanceof HTMLAnchorElement);if(e){const i=decodeURIComponent(e.hash?.substring(1)),s=this.headingIdxMap.get(i);s!==void 0?this.anchorNavTarget=this.headings[s]:this.anchorNavTarget=null}};isInRange(t,e,i){return e<t&&t<i}connectedCallback(){const t=document.querySelector(".prose");t?t.addEventListener("animationend",()=>{this.init()},{once:!0}):console.debug("Animation element not found")}init(){if(this.tocEl=document.getElementById("toc-inner-wrapper"),!!this.tocEl&&(this.tocEl.addEventListener("click",this.handleAnchorClick,{capture:!0}),this.activeIndicator=document.getElementById("active-indicator"),this.tocEntries=Array.from(document.querySelectorAll("#toc a[href^='#']")),this.tocEntries.length!==0)){this.sections=new Array(this.tocEntries.length),this.headings=new Array(this.tocEntries.length);for(let t=0;t<this.tocEntries.length;t++){const e=decodeURIComponent(this.tocEntries[t].hash?.substring(1)),i=document.getElementById(e),s=i?.parentElement;i instanceof HTMLElement&&s instanceof HTMLElement&&(this.headings[t]=i,this.sections[t]=s,this.headingIdxMap.set(e,t))}this.active=new Array(this.tocEntries.length).fill(!1),this.sections.forEach(t=>this.observer.observe(t)),this.fallback(),this.update()}}disconnectedCallback(){this.sections.forEach(t=>this.observer.unobserve(t)),this.observer.disconnect(),this.tocEl?.removeEventListener("click",this.handleAnchorClick)}}customElements.get("table-of-contents")||customElements.define("table-of-contents",l);</script> <div class="h-8 w-full"></div> </div> </div> </div> <!-- #toc needs to exist for Swup to work normally -->  </div> </div>  <!-- increase the page height during page transition to prevent the scrolling animation from jumping --> <div id="page-height-extend" class="hidden h-[300vh]" data-astro-cid-sckkx6r4 style="--bannerOffset: 15vh;--banner-height-home: 65vh;--banner-height: 35vh;--configHue: 215;--page-width: 75rem;--bg-url: url(https://api3-erciyuan-image.xcqcoo.top);--bg-enable: 1;--bg-position: center;--bg-size: cover;--bg-repeat: no-repeat;--bg-attachment: fixed;--bg-opacity: 0.5;"></div> <!-- 域名检测脚本 --> <script>(function(){const officialSites = [{"url":"https://blog.xcqcoo.top","alias":"Netlify"},{"url":"https://cf-blog.xcqcoo.top","alias":"Cloudflare"},{"url":"https://eo-blog.xcqcoo.top","alias":"EdgeOne"},{"url":"http://localhost:4321","alias":"Dev"}];

			// 域名检测功能
			function checkDomain() {
				try {
					// 获取当前访问的完整URL
					const currentUrl = window.location.href;
					// 获取当前域名
					const currentDomain = window.location.hostname;
					
					// 获取所有官方域名
					const officialDomains = officialSites.map(site => {
						try {
                            const url = typeof site === 'string' ? site : site.url;
							return new URL(url).hostname;
						} catch (e) {
							return null;
						}
					}).filter(domain => domain !== null);
					
					// 检查当前域名是否为官方域名或本地开发环境
					const isOfficialDomain = officialDomains.includes(currentDomain);
					const isLocalDev = currentDomain === 'localhost' || currentDomain === '127.0.0.1';
					
					// 如果当前域名不是官方域名且不是本地开发环境
					if (!isOfficialDomain && !isLocalDev) {
						// 创建警告弹窗
						const shouldRedirect = confirm(
							`⚠️ 域名安全警告\n\n` +
							`您当前访问的域名：${currentDomain}\n` +
							`官方域名：${officialDomains.join(', ')}\n\n` +
							`您可能正在访问非官方网站，存在安全风险！\n\n` +
							`点击"确定"跳转到官方网站\n` +
							`点击"取消"继续访问当前网站（不推荐）`
						);
						
						// 如果用户选择跳转到官方网站
						if (shouldRedirect) {
							// 构建官方网站的对应页面URL（使用第一个官方网站）
							const currentPath = window.location.pathname + window.location.search + window.location.hash;
                            const firstSite = officialSites[0];
                            const firstUrl = typeof firstSite === 'string' ? firstSite : firstSite.url;
							const officialPageUrl = firstUrl + currentPath;
							// 跳转到官方网站
							window.location.href = officialPageUrl;
						}
					}
				} catch (error) {
					// 如果检测过程中出现错误，静默处理，不影响正常访问
					console.warn('域名检测失败:', error);
				}
			}
			
			// 页面加载完成后执行域名检测
			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', checkDomain);
			} else {
				checkDomain();
			}
		})();</script> <vercel-analytics data-props="{&#34;data-astro-cid-sckkx6r4&#34;:true}" data-params="{}" data-pathname="/"></vercel-analytics> <script type="module">var f="@vercel/analytics",l="1.6.1",w=()=>{window.va||(window.va=function(...r){(window.vaq=window.vaq||[]).push(r)})};function d(){return typeof window<"u"}function u(){try{const e="production"}catch{}return"production"}function v(e="auto"){if(e==="auto"){window.vam=u();return}window.vam=e}function m(){return(d()?window.vam:u())||"production"}function c(){return m()==="development"}function b(e,r){if(!e||!r)return e;let n=e;try{const t=Object.entries(r);for(const[a,i]of t)if(!Array.isArray(i)){const o=s(i);o.test(n)&&(n=n.replace(o,`/[${a}]`))}for(const[a,i]of t)if(Array.isArray(i)){const o=s(i.join("/"));o.test(n)&&(n=n.replace(o,`/[...${a}]`))}return n}catch{return e}}function s(e){return new RegExp(`/${h(e)}(?=[/?#]|$)`)}function h(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(e){return e.scriptSrc?e.scriptSrc:c()?"https://va.vercel-scripts.com/v1/script.debug.js":e.basePath?`${e.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function g(e={debug:!0}){var r;if(!d())return;v(e.mode),w(),e.beforeSend&&((r=window.va)==null||r.call(window,"beforeSend",e.beforeSend));const n=y(e);if(document.head.querySelector(`script[src*="${n}"]`))return;const t=document.createElement("script");t.src=n,t.defer=!0,t.dataset.sdkn=f+(e.framework?`/${e.framework}`:""),t.dataset.sdkv=l,e.disableAutoTrack&&(t.dataset.disableAutoTrack="1"),e.endpoint?t.dataset.endpoint=e.endpoint:e.basePath&&(t.dataset.endpoint=`${e.basePath}/insights`),e.dsn&&(t.dataset.dsn=e.dsn),t.onerror=()=>{const a=c()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${n}. ${a}`)},c()&&e.debug===!1&&(t.dataset.debug="false"),document.head.appendChild(t)}function p({route:e,path:r}){var n;(n=window.va)==null||n.call(window,"pageview",{route:e,path:r})}function k(){try{return}catch{}}customElements.define("vercel-analytics",class extends HTMLElement{constructor(){super();try{const r=JSON.parse(this.dataset.props??"{}"),n=JSON.parse(this.dataset.params??"{}");g({...r,disableAutoTrack:!0,framework:"astro",basePath:k(),beforeSend:window.webAnalyticsBeforeSend});const t=this.dataset.pathname;p({route:b(t??"",n),path:t})}catch(r){throw new Error(`Failed to parse WebAnalytics properties: ${r}`)}}});</script>  <script type="module" src="/_astro/Layout.astro_astro_type_script_index_0_lang.CQ182X93.js"></script> <script type="module" src="/_astro/Layout.astro_astro_type_script_index_1_lang.8aBRKgP2.js"></script></body></html>